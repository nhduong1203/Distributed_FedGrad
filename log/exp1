INFO:root:Running Attack of the tails with args: Namespace(adv_lr=0.02, adversarial_local_training_period=3, attack_case='edge-case', attack_method='blackbox', attacker_percent=0.25, attacker_pool_size=100, batch_size=32, clients_per_verifier=6, dataset='cifar10', defense_method='fedgrad', degree_nonIID=0.5, device='cuda:0', epochs=14, eps=2.0, fl_mode='fixed-pool', fl_round=500, fraction=0.1, gamma=0.998, instance='benchmark', local_train_period=3, log_folder='logging', log_interval=100, lr=0.02, malicious_verifier='normal', model='vgg9', model_replacement=False, no_cuda=False, norm_bound=2.0, num_nets=150, number_verifiers=15, part_nets_per_round=30, pdr=0.33, poison_type='southwest', project_frequency=10, prox_attack=False, rand_seed=7, randomChoose=True, seed=1, stddev=0.025, test_batch_size=1000, updateSelection=True, use_trustworthy=True, wandb_group='Scenario 1')
INFO:root:cuda:0
INFO:root:==> Building model..
INFO:root:Seeded everything
INFO:root:OOD (Southwest Airline) train-data shape we collected: (784, 32, 32, 3)
INFO:root:OOD (Southwest Airline) test-data shape we collected: (196, 32, 32, 3)
INFO:root:!!!!!!!!!!!Num poisoned data points in the mixed dataset: 200
INFO:root:!!!!!!!!!!!Num clean data points in the mixed dataset: 400
INFO:root:(600, 32, 32, 3)
INFO:root:(600,)
INFO:root:3685
INFO:root:GET_VGG_MODEL: Fetch vgg9
INFO:root:Loading checkpoint file successfully ...
INFO:root:Test the model performance on the entire task before FL process ... 
INFO:root:Accuracy of plane : 76.70 %
INFO:root:Accuracy of   car : 90.20 %
INFO:root:Accuracy of  bird : 49.00 %
INFO:root:Accuracy of   cat : 56.50 %
INFO:root:Accuracy of  deer : 75.00 %
INFO:root:Accuracy of   dog : 75.70 %
INFO:root:Accuracy of  frog : 92.60 %
INFO:root:Accuracy of horse : 83.60 %
INFO:root:Accuracy of  ship : 81.50 %
INFO:root:Accuracy of truck : 94.50 %
INFO:root:
Test set: Average loss: 0.0017, Accuracy: 7753/10000 (77.53%)

INFO:root:#### Targetted Accuracy of truck : 11.22 %
wandb: W&B API key is configured. Use `wandb login --relogin` to force relogin
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: | Waiting for wandb.init()...wandb: / Waiting for wandb.init()...wandb: - Waiting for wandb.init().../usr/bin/nvidia-modprobe: unrecognized option: "-s"

ERROR: Invalid commandline, please run `/usr/bin/nvidia-modprobe --help`
       for usage information.

/usr/bin/nvidia-modprobe: unrecognized option: "-s"

ERROR: Invalid commandline, please run `/usr/bin/nvidia-modprobe --help`
       for usage information.

wandb: Tracking run with wandb version 0.15.3
wandb: Run data is saved locally in /mnt/disk1/duongnh/Distributed_FedGrad/wandb/run-20230526_144859-nny1wfoj
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run benchmark
wandb: ⭐️ View project at https://wandb.ai/aiotlab/Backdoor%20attack%20in%20FL
wandb: 🚀 View run at https://wandb.ai/aiotlab/Backdoor%20attack%20in%20FL/runs/nny1wfoj
INFO:root:Posion type! southwest
INFO:root:Selected Attackers in FL iteration-1: [78, 65, 96, 5, 121, 34, 99, 35, 14, 113]
INFO:root:################## Starting fl round: 1
INFO:root:@@@@@@@@ Working on client (global-index): 78, which 0-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 1.925414
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.741768
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.618022
INFO:root:Accuracy of plane : 64.80 %
INFO:root:Accuracy of   car : 75.20 %
INFO:root:Accuracy of  bird : 70.90 %
INFO:root:Accuracy of   cat : 43.80 %
INFO:root:Accuracy of  deer : 67.40 %
INFO:root:Accuracy of   dog : 79.40 %
INFO:root:Accuracy of  frog : 75.60 %
INFO:root:Accuracy of horse : 75.20 %
INFO:root:Accuracy of  ship : 89.20 %
INFO:root:Accuracy of truck : 77.30 %
INFO:root:
Test set: Average loss: 0.0017, Accuracy: 7188/10000 (71.88%)

INFO:root:#### Targetted Accuracy of truck : 87.24 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 1 |, is 1.9353280067443848
INFO:root:@@@@@@@@ Working on client (global-index): 125, which 1-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/139 (0%)]	Loss: 1.709921
INFO:root:Train Epoch: 2 [0/139 (0%)]	Loss: 1.571325
INFO:root:Train Epoch: 3 [0/139 (0%)]	Loss: 1.489371
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 1 |, is 0.5935887098312378
INFO:root:@@@@@@@@ Working on client (global-index): 126, which 2-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/267 (0%)]	Loss: 1.787582
INFO:root:Train Epoch: 2 [0/267 (0%)]	Loss: 1.611533
INFO:root:Train Epoch: 3 [0/267 (0%)]	Loss: 1.639743
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 1 |, is 1.0461862087249756
INFO:root:@@@@@@@@ Working on client (global-index): 46, which 3-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/387 (0%)]	Loss: 1.820194
INFO:root:Train Epoch: 2 [0/387 (0%)]	Loss: 1.612152
INFO:root:Train Epoch: 3 [0/387 (0%)]	Loss: 1.602109
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 1 |, is 1.7759207487106323
INFO:root:@@@@@@@@ Working on client (global-index): 77, which 4-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/342 (0%)]	Loss: 1.722006
INFO:root:Train Epoch: 2 [0/342 (0%)]	Loss: 1.477818
INFO:root:Train Epoch: 3 [0/342 (0%)]	Loss: 1.464051
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 1 |, is 1.1485406160354614
INFO:root:@@@@@@@@ Working on client (global-index): 69, which 5-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/336 (0%)]	Loss: 1.887890
INFO:root:Train Epoch: 2 [0/336 (0%)]	Loss: 1.748588
INFO:root:Train Epoch: 3 [0/336 (0%)]	Loss: 1.716610
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 1 |, is 1.2614268064498901
INFO:root:@@@@@@@@ Working on client (global-index): 84, which 6-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/350 (0%)]	Loss: 1.776726
INFO:root:Train Epoch: 2 [0/350 (0%)]	Loss: 1.688839
INFO:root:Train Epoch: 3 [0/350 (0%)]	Loss: 1.541667
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 1 |, is 1.1001167297363281
INFO:root:@@@@@@@@ Working on client (global-index): 131, which 7-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/121 (0%)]	Loss: 1.647638
INFO:root:Train Epoch: 2 [0/121 (0%)]	Loss: 1.613464
INFO:root:Train Epoch: 3 [0/121 (0%)]	Loss: 1.568193
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 1 |, is 0.5081618428230286
INFO:root:@@@@@@@@ Working on client (global-index): 65, which 8-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 1.950312
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.683353
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.659058
INFO:root:Accuracy of plane : 33.90 %
INFO:root:Accuracy of   car : 54.00 %
INFO:root:Accuracy of  bird : 53.30 %
INFO:root:Accuracy of   cat : 75.40 %
INFO:root:Accuracy of  deer : 63.80 %
INFO:root:Accuracy of   dog : 33.40 %
INFO:root:Accuracy of  frog : 88.00 %
INFO:root:Accuracy of horse : 50.60 %
INFO:root:Accuracy of  ship : 74.80 %
INFO:root:Accuracy of truck : 94.30 %
INFO:root:
Test set: Average loss: 0.0018, Accuracy: 6215/10000 (62.15%)

INFO:root:#### Targetted Accuracy of truck : 100.00 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 1 |, is 2.047588586807251
INFO:root:@@@@@@@@ Working on client (global-index): 96, which 9-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 2.020190
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.693920
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.572888
INFO:root:Accuracy of plane : 31.40 %
INFO:root:Accuracy of   car : 79.00 %
INFO:root:Accuracy of  bird : 36.40 %
INFO:root:Accuracy of   cat : 78.10 %
INFO:root:Accuracy of  deer : 77.50 %
INFO:root:Accuracy of   dog : 34.40 %
INFO:root:Accuracy of  frog : 88.50 %
INFO:root:Accuracy of horse : 64.60 %
INFO:root:Accuracy of  ship : 85.10 %
INFO:root:Accuracy of truck : 91.40 %
INFO:root:
Test set: Average loss: 0.0018, Accuracy: 6664/10000 (66.64%)

INFO:root:#### Targetted Accuracy of truck : 100.00 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 1 |, is 1.9317790269851685
INFO:root:@@@@@@@@ Working on client (global-index): 120, which 10-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/334 (0%)]	Loss: 1.745189
INFO:root:Train Epoch: 2 [0/334 (0%)]	Loss: 1.510955
INFO:root:Train Epoch: 3 [0/334 (0%)]	Loss: 1.491788
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 1 |, is 1.2079278230667114
INFO:root:@@@@@@@@ Working on client (global-index): 23, which 11-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/335 (0%)]	Loss: 1.631264
INFO:root:Train Epoch: 2 [0/335 (0%)]	Loss: 1.553083
INFO:root:Train Epoch: 3 [0/335 (0%)]	Loss: 1.555911
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 1 |, is 1.0427461862564087
INFO:root:@@@@@@@@ Working on client (global-index): 45, which 12-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/247 (0%)]	Loss: 1.569085
INFO:root:Train Epoch: 2 [0/247 (0%)]	Loss: 1.546687
INFO:root:Train Epoch: 3 [0/247 (0%)]	Loss: 1.521223
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 1 |, is 0.8968479037284851
INFO:root:@@@@@@@@ Working on client (global-index): 5, which 13-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 1.889218
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.710393
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.605919
INFO:root:Accuracy of plane : 33.30 %
INFO:root:Accuracy of   car : 53.00 %
INFO:root:Accuracy of  bird : 38.60 %
INFO:root:Accuracy of   cat : 32.40 %
INFO:root:Accuracy of  deer : 66.30 %
INFO:root:Accuracy of   dog : 70.40 %
INFO:root:Accuracy of  frog : 84.10 %
INFO:root:Accuracy of horse : 86.00 %
INFO:root:Accuracy of  ship : 78.50 %
INFO:root:Accuracy of truck : 97.20 %
INFO:root:
Test set: Average loss: 0.0018, Accuracy: 6398/10000 (63.98%)

INFO:root:#### Targetted Accuracy of truck : 100.00 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 1 |, is 2.0485637187957764
INFO:root:@@@@@@@@ Working on client (global-index): 149, which 14-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/301 (0%)]	Loss: 1.765603
INFO:root:Train Epoch: 2 [0/301 (0%)]	Loss: 1.583801
INFO:root:Train Epoch: 3 [0/301 (0%)]	Loss: 1.588263
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 1 |, is 1.063681960105896
INFO:root:@@@@@@@@ Working on client (global-index): 30, which 15-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/365 (0%)]	Loss: 1.719093
INFO:root:Train Epoch: 2 [0/365 (0%)]	Loss: 1.687924
INFO:root:Train Epoch: 3 [0/365 (0%)]	Loss: 1.544078
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 1 |, is 1.2223981618881226
INFO:root:@@@@@@@@ Working on client (global-index): 121, which 16-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 1.932091
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.669121
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.682923
INFO:root:Accuracy of plane : 51.40 %
INFO:root:Accuracy of   car : 54.60 %
INFO:root:Accuracy of  bird : 66.40 %
INFO:root:Accuracy of   cat : 34.50 %
INFO:root:Accuracy of  deer : 67.30 %
INFO:root:Accuracy of   dog : 43.40 %
INFO:root:Accuracy of  frog : 74.80 %
INFO:root:Accuracy of horse : 79.80 %
INFO:root:Accuracy of  ship : 81.40 %
INFO:root:Accuracy of truck : 95.30 %
INFO:root:
Test set: Average loss: 0.0018, Accuracy: 6489/10000 (64.89%)

INFO:root:#### Targetted Accuracy of truck : 99.49 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 1 |, is 2.0903749465942383
INFO:root:@@@@@@@@ Working on client (global-index): 34, which 17-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 1.925255
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.715880
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.642433
INFO:root:Accuracy of plane : 53.60 %
INFO:root:Accuracy of   car : 93.40 %
INFO:root:Accuracy of  bird : 51.40 %
INFO:root:Accuracy of   cat : 28.50 %
INFO:root:Accuracy of  deer : 80.10 %
INFO:root:Accuracy of   dog : 58.20 %
INFO:root:Accuracy of  frog : 81.10 %
INFO:root:Accuracy of horse : 85.10 %
INFO:root:Accuracy of  ship : 75.00 %
INFO:root:Accuracy of truck : 77.60 %
INFO:root:
Test set: Average loss: 0.0018, Accuracy: 6840/10000 (68.40%)

INFO:root:#### Targetted Accuracy of truck : 97.96 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 1 |, is 2.0184242725372314
INFO:root:@@@@@@@@ Working on client (global-index): 122, which 18-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/651 (0%)]	Loss: 1.725211
INFO:root:Train Epoch: 2 [0/651 (0%)]	Loss: 1.595114
INFO:root:Train Epoch: 3 [0/651 (0%)]	Loss: 1.613302
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 1 |, is 1.6774139404296875
INFO:root:@@@@@@@@ Working on client (global-index): 99, which 19-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 1.818132
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.582897
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.612879
INFO:root:Accuracy of plane : 34.60 %
INFO:root:Accuracy of   car : 58.30 %
INFO:root:Accuracy of  bird : 52.10 %
INFO:root:Accuracy of   cat : 61.20 %
INFO:root:Accuracy of  deer : 83.50 %
INFO:root:Accuracy of   dog : 54.20 %
INFO:root:Accuracy of  frog : 88.60 %
INFO:root:Accuracy of horse : 78.40 %
INFO:root:Accuracy of  ship : 60.10 %
INFO:root:Accuracy of truck : 92.10 %
INFO:root:
Test set: Average loss: 0.0018, Accuracy: 6631/10000 (66.31%)

INFO:root:#### Targetted Accuracy of truck : 100.00 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 1 |, is 1.9698967933654785
INFO:root:@@@@@@@@ Working on client (global-index): 80, which 20-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/212 (0%)]	Loss: 1.709854
INFO:root:Train Epoch: 2 [0/212 (0%)]	Loss: 1.529075
INFO:root:Train Epoch: 3 [0/212 (0%)]	Loss: 1.598109
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 1 |, is 0.7729380130767822
INFO:root:@@@@@@@@ Working on client (global-index): 35, which 21-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 2.062865
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.675725
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.535046
INFO:root:Accuracy of plane : 72.90 %
INFO:root:Accuracy of   car : 91.00 %
INFO:root:Accuracy of  bird : 68.30 %
INFO:root:Accuracy of   cat : 56.60 %
INFO:root:Accuracy of  deer : 65.50 %
INFO:root:Accuracy of   dog : 42.00 %
INFO:root:Accuracy of  frog : 88.60 %
INFO:root:Accuracy of horse : 87.10 %
INFO:root:Accuracy of  ship : 74.60 %
INFO:root:Accuracy of truck : 77.40 %
INFO:root:
Test set: Average loss: 0.0017, Accuracy: 7240/10000 (72.40%)

INFO:root:#### Targetted Accuracy of truck : 89.29 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 1 |, is 1.998348355293274
INFO:root:@@@@@@@@ Working on client (global-index): 147, which 22-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/331 (0%)]	Loss: 1.844405
INFO:root:Train Epoch: 2 [0/331 (0%)]	Loss: 1.738997
INFO:root:Train Epoch: 3 [0/331 (0%)]	Loss: 1.628222
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 1 |, is 1.1799864768981934
INFO:root:@@@@@@@@ Working on client (global-index): 135, which 23-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/299 (0%)]	Loss: 1.601230
INFO:root:Train Epoch: 2 [0/299 (0%)]	Loss: 1.553997
INFO:root:Train Epoch: 3 [0/299 (0%)]	Loss: 1.492173
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 1 |, is 0.8849186301231384
INFO:root:@@@@@@@@ Working on client (global-index): 14, which 24-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 1.929213
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.701166
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.639999
INFO:root:Accuracy of plane : 54.60 %
INFO:root:Accuracy of   car : 82.00 %
INFO:root:Accuracy of  bird : 54.90 %
INFO:root:Accuracy of   cat : 63.50 %
INFO:root:Accuracy of  deer : 67.00 %
INFO:root:Accuracy of   dog : 76.10 %
INFO:root:Accuracy of  frog : 71.10 %
INFO:root:Accuracy of horse : 79.10 %
INFO:root:Accuracy of  ship : 64.20 %
INFO:root:Accuracy of truck : 91.50 %
INFO:root:
Test set: Average loss: 0.0018, Accuracy: 7040/10000 (70.40%)

INFO:root:#### Targetted Accuracy of truck : 97.96 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 1 |, is 1.9946777820587158
INFO:root:@@@@@@@@ Working on client (global-index): 36, which 25-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/133 (0%)]	Loss: 1.715945
INFO:root:Train Epoch: 2 [0/133 (0%)]	Loss: 1.601047
INFO:root:Train Epoch: 3 [0/133 (0%)]	Loss: 1.611739
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 1 |, is 0.7950882911682129
INFO:root:@@@@@@@@ Working on client (global-index): 113, which 26-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 1.934529
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.822125
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.652967
INFO:root:Accuracy of plane : 53.40 %
INFO:root:Accuracy of   car : 76.60 %
INFO:root:Accuracy of  bird : 51.70 %
INFO:root:Accuracy of   cat : 30.10 %
INFO:root:Accuracy of  deer : 60.40 %
INFO:root:Accuracy of   dog : 28.80 %
INFO:root:Accuracy of  frog : 83.90 %
INFO:root:Accuracy of horse : 87.50 %
INFO:root:Accuracy of  ship : 87.80 %
INFO:root:Accuracy of truck : 93.10 %
INFO:root:
Test set: Average loss: 0.0018, Accuracy: 6533/10000 (65.33%)

INFO:root:#### Targetted Accuracy of truck : 96.43 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 1 |, is 2.036630868911743
INFO:root:@@@@@@@@ Working on client (global-index): 8, which 27-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/395 (0%)]	Loss: 1.820444
INFO:root:Train Epoch: 2 [0/395 (0%)]	Loss: 1.538874
INFO:root:Train Epoch: 3 [0/395 (0%)]	Loss: 1.619500
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 1 |, is 1.1567223072052002
INFO:root:@@@@@@@@ Working on client (global-index): 108, which 28-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/377 (0%)]	Loss: 1.738859
INFO:root:Train Epoch: 2 [0/377 (0%)]	Loss: 1.658766
INFO:root:Train Epoch: 3 [0/377 (0%)]	Loss: 1.553934
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 1 |, is 1.3326878547668457
INFO:root:@@@@@@@@ Working on client (global-index): 79, which 29-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/508 (0%)]	Loss: 1.763476
INFO:root:Train Epoch: 2 [0/508 (0%)]	Loss: 1.461151
INFO:root:Train Epoch: 3 [0/508 (0%)]	Loss: 1.461151
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 1 |, is 1.3141753673553467
INFO:root:GET_VGG_MODEL: Fetch vgg9
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
num_data_points:  [600, 139, 267, 387, 342, 336, 350, 121, 600, 600, 334, 335, 247, 600, 301, 365, 600, 600, 651, 600, 212, 600, 331, 299, 600, 133, 600, 395, 377, 508]
total_num_dps_per_round: 12430
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
epsilon_1:  0.5
[Soft-filter] predicted suspicious set is:  [5, 126, 108, 34]
Total computation time of the 1st layer is: 2.14697265625
[Hard-filter] predicted suspicious set is:  [126, 108, 79]
Total computation time of the 2nd layer is: 632.261474609375
[Final-result] predicted suspicious set is: [5, 126, 108, 34]
verifier: 0, true positive: 1.0, true negative: 0.5, false positive: 0.5

predict honest: [131, 79]

predict attacker: [5, 126, 108, 34]

true attacker: [5, 34]

------------------------------------------------------------------------------------
epsilon_1:  0.43433679141325765
[Soft-filter] predicted suspicious set is:  [113, 122, 46]
Total computation time of the 1st layer is: 1.66357421875
[Hard-filter] predicted suspicious set is:  [125, 113, 122]
Total computation time of the 2nd layer is: 323.527587890625
[Final-result] predicted suspicious set is: [113, 122, 46]
verifier: 1, true positive: 1.0, true negative: 0.6, false positive: 0.4

predict honest: [125, 131, 80]

predict attacker: [113, 122, 46]

true attacker: [113]

------------------------------------------------------------------------------------
epsilon_1:  0.4352264071046801
[Soft-filter] predicted suspicious set is:  [122, 108, 113]
Total computation time of the 1st layer is: 1.26318359375
[Hard-filter] predicted suspicious set is:  [80, 45]
Total computation time of the 2nd layer is: 323.09765625
[Final-result] predicted suspicious set is: [122, 108, 113]
verifier: 2, true positive: 1.0, true negative: 0.6, false positive: 0.4

predict honest: [80, 125, 45]

predict attacker: [122, 108, 113]

true attacker: [113]

------------------------------------------------------------------------------------
epsilon_1:  0.4307045271686911
[Soft-filter] predicted suspicious set is:  [79, 34, 96]
Total computation time of the 1st layer is: 1.30029296875
[Hard-filter] predicted suspicious set is:  [79, 77]
Total computation time of the 2nd layer is: 364.113037109375
[Final-result] predicted suspicious set is: [79, 34, 96]
verifier: 3, true positive: 1.0, true negative: 0.75, false positive: 0.25

predict honest: [125, 131, 77]

predict attacker: [79, 34, 96]

true attacker: [34, 96]

------------------------------------------------------------------------------------
epsilon_1:  0.5
[Soft-filter] predicted suspicious set is:  [5, 34, 122, 96]
Total computation time of the 1st layer is: 1.29248046875
[Hard-filter] predicted suspicious set is:  [5, 34, 122, 96]
Total computation time of the 2nd layer is: 322.490478515625
[Final-result] predicted suspicious set is: [5, 34, 122, 96]
verifier: 4, true positive: 1.0, true negative: 0.6666666666666667, false positive: 0.3333333333333333

predict honest: [77, 46]

predict attacker: [5, 34, 122, 96]

true attacker: [5, 34, 96]

------------------------------------------------------------------------------------
epsilon_1:  0.5
[Soft-filter] predicted suspicious set is:  [34, 113, 35]
Total computation time of the 1st layer is: 1.2763671875
[Hard-filter] predicted suspicious set is:  [34, 113, 35, 122]
Total computation time of the 2nd layer is: 323.348876953125
[Final-result] predicted suspicious set is: [34, 113, 35]
verifier: 5, true positive: 1.0, true negative: 1.0, false positive: 0.0

predict honest: [69, 46, 122]

predict attacker: [34, 113, 35]

true attacker: [34, 113, 35]

------------------------------------------------------------------------------------
epsilon_1:  0.38377512430219607
[Soft-filter] predicted suspicious set is:  [122, 84, 34]
Total computation time of the 1st layer is: 1.441162109375
[Hard-filter] predicted suspicious set is:  [122, 23, 34]
Total computation time of the 2nd layer is: 347.00927734375
[Final-result] predicted suspicious set is: [122, 84, 34]
verifier: 6, true positive: 1.0, true negative: 0.6, false positive: 0.4

predict honest: [80, 23, 46]

predict attacker: [122, 84, 34]

true attacker: [34]

------------------------------------------------------------------------------------
epsilon_1:  0.41167274835233597
[Soft-filter] predicted suspicious set is:  [147, 122, 99]
Total computation time of the 1st layer is: 1.789794921875
[Hard-filter] predicted suspicious set is:  [147, 126]
Total computation time of the 2nd layer is: 334.57080078125
[Final-result] predicted suspicious set is: [147, 122, 99]
verifier: 7, true positive: 1.0, true negative: 0.6, false positive: 0.4

predict honest: [126, 125, 84]

predict attacker: [147, 122, 99]

true attacker: [99]

------------------------------------------------------------------------------------
epsilon_1:  0.5
[Soft-filter] predicted suspicious set is:  [35, 34, 5, 14]
Total computation time of the 1st layer is: 1.7880859375
[Hard-filter] predicted suspicious set is:  [120]
Total computation time of the 2nd layer is: 336.41943359375
[Final-result] predicted suspicious set is: [35, 34, 5, 14]
verifier: 8, true positive: 1.0, true negative: 1.0, false positive: 0.0

predict honest: [30, 120]

predict attacker: [35, 34, 5, 14]

true attacker: [35, 34, 5, 14]

------------------------------------------------------------------------------------
epsilon_1:  0.4755334832565643
[Soft-filter] predicted suspicious set is:  [149, 122, 96]
Total computation time of the 1st layer is: 1.90771484375
[Hard-filter] predicted suspicious set is:  [79]
Total computation time of the 2nd layer is: 334.835693359375
[Final-result] predicted suspicious set is: [149, 122, 96]
verifier: 9, true positive: 1.0, true negative: 0.6, false positive: 0.4

predict honest: [79, 23, 131]

predict attacker: [149, 122, 96]

true attacker: [96]

------------------------------------------------------------------------------------
epsilon_1:  0.5
[Soft-filter] predicted suspicious set is:  [69, 147, 14, 126]
Total computation time of the 1st layer is: 2.152587890625
[Hard-filter] predicted suspicious set is:  [147, 14, 126]
Total computation time of the 2nd layer is: 364.978271484375
[Final-result] predicted suspicious set is: [69, 147, 14, 126]
verifier: 10, true positive: 1.0, true negative: 0.4, false positive: 0.6

predict honest: [36, 131]

predict attacker: [69, 147, 14, 126]

true attacker: [14]

------------------------------------------------------------------------------------
epsilon_1:  0.40434943988196487
INFO:root:GET_VGG_MODEL: Fetch vgg9
INFO:root:===> ND `|w_avg-w_g|` in local epoch: 0 | FL round: 1 |, is 0.0
INFO:root:Measuring the accuracy of the averaged global model, FL round: 1 ...
INFO:root:Accuracy of plane : 95.80 %
INFO:root:Accuracy of   car : 96.30 %
INFO:root:Accuracy of  bird : 54.90 %
INFO:root:Accuracy of   cat : 46.60 %
INFO:root:Accuracy of  deer : 72.90 %
INFO:root:Accuracy of   dog : 69.20 %
INFO:root:Accuracy of  frog : 92.70 %
INFO:root:Accuracy of horse : 87.60 %
INFO:root:Accuracy of  ship : 84.10 %
INFO:root:Accuracy of truck : 78.60 %
INFO:root:
Test set: Average loss: 0.0017, Accuracy: 7787/10000 (77.87%)

INFO:root:#### Targetted Accuracy of truck : 4.08 %
INFO:root:Selected Attackers in FL iteration-2: [42, 72, 89, 144, 35, 90, 129, 65]
INFO:root:################## Starting fl round: 2
INFO:root:@@@@@@@@ Working on client (global-index): 32, which 0-th user in the current round
INFO:root:Effective lr in FL round: 2 is 0.019960000000000002
INFO:root:Train Epoch: 1 [0/276 (0%)]	Loss: 1.799846
INFO:root:Train Epoch: 2 [0/276 (0%)]	Loss: 1.637651
INFO:root:Train Epoch: 3 [0/276 (0%)]	Loss: 1.662986
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 2 |, is 1.018779993057251
INFO:root:@@@@@@@@ Working on client (global-index): 105, which 1-th user in the current round
INFO:root:Effective lr in FL round: 2 is 0.019960000000000002
INFO:root:Train Epoch: 1 [0/350 (0%)]	Loss: 1.664254
INFO:root:Train Epoch: 2 [0/350 (0%)]	Loss: 1.518843
INFO:root:Train Epoch: 3 [0/350 (0%)]	Loss: 1.554051
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 2 |, is 1.1213771104812622
INFO:root:@@@@@@@@ Working on client (global-index): 0, which 2-th user in the current round
INFO:root:Effective lr in FL round: 2 is 0.019960000000000002
INFO:root:Train Epoch: 1 [0/305 (0%)]	Loss: 1.738335
INFO:root:Train Epoch: 2 [0/305 (0%)]	Loss: 1.747947
INFO:root:Train Epoch: 3 [0/305 (0%)]	Loss: 1.615436
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 2 |, is 0.980833113193512
INFO:root:@@@@@@@@ Working on client (global-index): 142, which 3-th user in the current round
INFO:root:Effective lr in FL round: 2 is 0.019960000000000002
INFO:root:Train Epoch: 1 [0/399 (0%)]	Loss: 1.577717
INFO:root:Train Epoch: 2 [0/399 (0%)]	Loss: 1.503894
INFO:root:Train Epoch: 3 [0/399 (0%)]	Loss: 1.461495
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 2 |, is 0.8372704982757568
INFO:root:@@@@@@@@ Working on client (global-index): 122, which 4-th user in the current round
INFO:root:Effective lr in FL round: 2 is 0.019960000000000002
INFO:root:Train Epoch: 1 [0/651 (0%)]	Loss: 1.691019
INFO:root:Train Epoch: 2 [0/651 (0%)]	Loss: 1.590982
INFO:root:Train Epoch: 3 [0/651 (0%)]	Loss: 1.647410
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 2 |, is 1.8074638843536377
INFO:root:@@@@@@@@ Working on client (global-index): 45, which 5-th user in the current round
INFO:root:Effective lr in FL round: 2 is 0.019960000000000002
INFO:root:Train Epoch: 1 [0/247 (0%)]	Loss: 1.522226
INFO:root:Train Epoch: 2 [0/247 (0%)]	Loss: 1.531545
INFO:root:Train Epoch: 3 [0/247 (0%)]	Loss: 1.488925
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 2 |, is 0.8285635113716125
INFO:root:@@@@@@@@ Working on client (global-index): 143, which 6-th user in the current round
INFO:root:Effective lr in FL round: 2 is 0.019960000000000002
INFO:root:Train Epoch: 1 [0/339 (0%)]	Loss: 1.727508
INFO:root:Train Epoch: 2 [0/339 (0%)]	Loss: 1.632145
INFO:root:Train Epoch: 3 [0/339 (0%)]	Loss: 1.542469
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 2 |, is 1.2370840311050415
INFO:root:@@@@@@@@ Working on client (global-index): 80, which 7-th user in the current round
INFO:root:Effective lr in FL round: 2 is 0.019960000000000002
INFO:root:Train Epoch: 1 [0/212 (0%)]	Loss: 1.525186
INFO:root:Train Epoch: 2 [0/212 (0%)]	Loss: 1.559668
INFO:root:Train Epoch: 3 [0/212 (0%)]	Loss: 1.526595
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 2 |, is 0.5743429660797119
INFO:root:@@@@@@@@ Working on client (global-index): 70, which 8-th user in the current round
INFO:root:Effective lr in FL round: 2 is 0.019960000000000002
INFO:root:Train Epoch: 1 [0/336 (0%)]	Loss: 1.812296
INFO:root:Train Epoch: 2 [0/336 (0%)]	Loss: 1.570571
INFO:root:Train Epoch: 3 [0/336 (0%)]	Loss: 1.525637
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 2 |, is 1.1342697143554688
INFO:root:@@@@@@@@ Working on client (global-index): 42, which 9-th user in the current round
INFO:root:Effective lr in FL round: 2 is 0.019960000000000002
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 1.965175
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.828537
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.759932
INFO:root:Accuracy of plane : 30.30 %
INFO:root:Accuracy of   car : 76.10 %
INFO:root:Accuracy of  bird : 38.70 %
INFO:root:Accuracy of   cat : 45.00 %
INFO:root:Accuracy of  deer : 67.40 %
INFO:root:Accuracy of   dog : 66.30 %
INFO:root:Accuracy of  frog : 91.50 %
INFO:root:Accuracy of horse : 84.80 %
INFO:root:Accuracy of  ship : 72.20 %
INFO:root:Accuracy of truck : 92.80 %
INFO:root:
Test set: Average loss: 0.0018, Accuracy: 6651/10000 (66.51%)

INFO:root:#### Targetted Accuracy of truck : 100.00 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 2 |, is 2.0519378185272217
INFO:root:@@@@@@@@ Working on client (global-index): 25, which 10-th user in the current round
INFO:root:Effective lr in FL round: 2 is 0.019960000000000002
INFO:root:Train Epoch: 1 [0/602 (0%)]	Loss: 1.665108
INFO:root:Train Epoch: 2 [0/602 (0%)]	Loss: 1.563600
INFO:root:Train Epoch: 3 [0/602 (0%)]	Loss: 1.615556
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 2 |, is 1.7113007307052612
INFO:root:@@@@@@@@ Working on client (global-index): 115, which 11-th user in the current round
INFO:root:Effective lr in FL round: 2 is 0.019960000000000002
INFO:root:Train Epoch: 1 [0/301 (0%)]	Loss: 1.658788
INFO:root:Train Epoch: 2 [0/301 (0%)]	Loss: 1.627349
INFO:root:Train Epoch: 3 [0/301 (0%)]	Loss: 1.624514
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 2 |, is 1.2766519784927368
INFO:root:@@@@@@@@ Working on client (global-index): 72, which 12-th user in the current round
INFO:root:Effective lr in FL round: 2 is 0.019960000000000002
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 1.985151
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.621161
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.637047
INFO:root:Accuracy of plane : 70.30 %
INFO:root:Accuracy of   car : 63.30 %
INFO:root:Accuracy of  bird : 55.50 %
INFO:root:Accuracy of   cat : 72.30 %
INFO:root:Accuracy of  deer : 37.50 %
INFO:root:Accuracy of   dog : 62.20 %
INFO:root:Accuracy of  frog : 88.10 %
INFO:root:Accuracy of horse : 86.10 %
INFO:root:Accuracy of  ship : 74.50 %
INFO:root:Accuracy of truck : 87.10 %
INFO:root:
Test set: Average loss: 0.0018, Accuracy: 6969/10000 (69.69%)

INFO:root:#### Targetted Accuracy of truck : 93.37 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 2 |, is 2.0942211151123047
INFO:root:@@@@@@@@ Working on client (global-index): 97, which 13-th user in the current round
INFO:root:Effective lr in FL round: 2 is 0.019960000000000002
INFO:root:Train Epoch: 1 [0/293 (0%)]	Loss: 1.636770
INFO:root:Train Epoch: 2 [0/293 (0%)]	Loss: 1.562297
INFO:root:Train Epoch: 3 [0/293 (0%)]	Loss: 1.623989
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 2 |, is 1.2550543546676636
INFO:root:@@@@@@@@ Working on client (global-index): 109, which 14-th user in the current round
INFO:root:Effective lr in FL round: 2 is 0.019960000000000002
INFO:root:Train Epoch: 1 [0/334 (0%)]	Loss: 1.740168
INFO:root:Train Epoch: 2 [0/334 (0%)]	Loss: 1.514380
INFO:root:Train Epoch: 3 [0/334 (0%)]	Loss: 1.481961
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 2 |, is 1.3707102537155151
INFO:root:@@@@@@@@ Working on client (global-index): 85, which 15-th user in the current round
INFO:root:Effective lr in FL round: 2 is 0.019960000000000002
INFO:root:Train Epoch: 1 [0/337 (0%)]	Loss: 1.812785
INFO:root:Train Epoch: 2 [0/337 (0%)]	Loss: 1.794397
INFO:root:Train Epoch: 3 [0/337 (0%)]	Loss: 1.541263
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 2 |, is 1.1179882287979126
INFO:root:@@@@@@@@ Working on client (global-index): 89, which 16-th user in the current round
INFO:root:Effective lr in FL round: 2 is 0.019960000000000002
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 1.874556
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.769405
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.696443
INFO:root:Accuracy of plane : 27.10 %
INFO:root:Accuracy of   car : 54.90 %
INFO:root:Accuracy of  bird : 46.40 %
INFO:root:Accuracy of   cat : 36.80 %
INFO:root:Accuracy of  deer : 72.30 %
INFO:root:Accuracy of   dog : 80.60 %
INFO:root:Accuracy of  frog : 90.40 %
INFO:root:Accuracy of horse : 78.00 %
INFO:root:Accuracy of  ship : 60.80 %
INFO:root:Accuracy of truck : 95.20 %
INFO:root:
Test set: Average loss: 0.0018, Accuracy: 6425/10000 (64.25%)

INFO:root:#### Targetted Accuracy of truck : 100.00 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 2 |, is 2.0217947959899902
INFO:root:@@@@@@@@ Working on client (global-index): 144, which 17-th user in the current round
INFO:root:Effective lr in FL round: 2 is 0.019960000000000002
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 1.931595
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.744067
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.699391
INFO:root:Accuracy of plane : 37.70 %
INFO:root:Accuracy of   car : 57.20 %
INFO:root:Accuracy of  bird : 43.00 %
INFO:root:Accuracy of   cat : 5.50 %
INFO:root:Accuracy of  deer : 84.70 %
INFO:root:Accuracy of   dog : 56.40 %
INFO:root:Accuracy of  frog : 71.80 %
INFO:root:Accuracy of horse : 86.90 %
INFO:root:Accuracy of  ship : 54.00 %
INFO:root:Accuracy of truck : 94.40 %
INFO:root:
Test set: Average loss: 0.0019, Accuracy: 5916/10000 (59.16%)

INFO:root:#### Targetted Accuracy of truck : 100.00 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 2 |, is 2.043606996536255
INFO:root:@@@@@@@@ Working on client (global-index): 35, which 18-th user in the current round
INFO:root:Effective lr in FL round: 2 is 0.019960000000000002
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 1.973753
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.625434
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.651844
INFO:root:Accuracy of plane : 71.40 %
INFO:root:Accuracy of   car : 75.60 %
INFO:root:Accuracy of  bird : 58.70 %
INFO:root:Accuracy of   cat : 45.30 %
INFO:root:Accuracy of  deer : 66.40 %
INFO:root:Accuracy of   dog : 85.80 %
INFO:root:Accuracy of  frog : 84.50 %
INFO:root:Accuracy of horse : 79.40 %
INFO:root:Accuracy of  ship : 85.10 %
INFO:root:Accuracy of truck : 79.10 %
INFO:root:
Test set: Average loss: 0.0017, Accuracy: 7313/10000 (73.13%)

INFO:root:#### Targetted Accuracy of truck : 88.27 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 2 |, is 1.9608607292175293
INFO:root:@@@@@@@@ Working on client (global-index): 111, which 19-th user in the current round
INFO:root:Effective lr in FL round: 2 is 0.019960000000000002
INFO:root:Train Epoch: 1 [0/186 (0%)]	Loss: 1.721463
INFO:root:Train Epoch: 2 [0/186 (0%)]	Loss: 1.556052
INFO:root:Train Epoch: 3 [0/186 (0%)]	Loss: 1.671774
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 2 |, is 0.7692500948905945
INFO:root:@@@@@@@@ Working on client (global-index): 47, which 20-th user in the current round
INFO:root:Effective lr in FL round: 2 is 0.019960000000000002
INFO:root:Train Epoch: 1 [0/246 (0%)]	Loss: 1.578331
INFO:root:Train Epoch: 2 [0/246 (0%)]	Loss: 1.475429
INFO:root:Train Epoch: 3 [0/246 (0%)]	Loss: 1.461570
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 2 |, is 0.6323713064193726
INFO:root:@@@@@@@@ Working on client (global-index): 90, which 21-th user in the current round
INFO:root:Effective lr in FL round: 2 is 0.019960000000000002
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 1.822857
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.649434
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.704680
INFO:root:Accuracy of plane : 41.80 %
INFO:root:Accuracy of   car : 77.70 %
INFO:root:Accuracy of  bird : 49.50 %
INFO:root:Accuracy of   cat : 28.50 %
INFO:root:Accuracy of  deer : 78.50 %
INFO:root:Accuracy of   dog : 82.20 %
INFO:root:Accuracy of  frog : 74.60 %
INFO:root:Accuracy of horse : 85.70 %
INFO:root:Accuracy of  ship : 72.30 %
INFO:root:Accuracy of truck : 88.80 %
INFO:root:
Test set: Average loss: 0.0018, Accuracy: 6796/10000 (67.96%)

INFO:root:#### Targetted Accuracy of truck : 99.49 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 2 |, is 2.006030559539795
INFO:root:@@@@@@@@ Working on client (global-index): 27, which 22-th user in the current round
INFO:root:Effective lr in FL round: 2 is 0.019960000000000002
INFO:root:Train Epoch: 1 [0/294 (0%)]	Loss: 1.796634
INFO:root:Train Epoch: 2 [0/294 (0%)]	Loss: 1.654966
INFO:root:Train Epoch: 3 [0/294 (0%)]	Loss: 1.633051
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 2 |, is 1.0635286569595337
INFO:root:@@@@@@@@ Working on client (global-index): 146, which 23-th user in the current round
INFO:root:Effective lr in FL round: 2 is 0.019960000000000002
INFO:root:Train Epoch: 1 [0/343 (0%)]	Loss: 1.685998
INFO:root:Train Epoch: 2 [0/343 (0%)]	Loss: 1.465054
INFO:root:Train Epoch: 3 [0/343 (0%)]	Loss: 1.612442
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 2 |, is 0.8875684142112732
INFO:root:@@@@@@@@ Working on client (global-index): 43, which 24-th user in the current round
INFO:root:Effective lr in FL round: 2 is 0.019960000000000002
INFO:root:Train Epoch: 1 [0/276 (0%)]	Loss: 1.640645
INFO:root:Train Epoch: 2 [0/276 (0%)]	Loss: 1.544751
INFO:root:Train Epoch: 3 [0/276 (0%)]	Loss: 1.584266
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 2 |, is 1.0356324911117554
INFO:root:@@@@@@@@ Working on client (global-index): 69, which 25-th user in the current round
INFO:root:Effective lr in FL round: 2 is 0.019960000000000002
INFO:root:Train Epoch: 1 [0/336 (0%)]	Loss: 1.835131
INFO:root:Train Epoch: 2 [0/336 (0%)]	Loss: 1.720639
INFO:root:Train Epoch: 3 [0/336 (0%)]	Loss: 1.670135
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 2 |, is 1.2393463850021362
INFO:root:@@@@@@@@ Working on client (global-index): 149, which 26-th user in the current round
INFO:root:Effective lr in FL round: 2 is 0.019960000000000002
INFO:root:Train Epoch: 1 [0/301 (0%)]	Loss: 1.655018
INFO:root:Train Epoch: 2 [0/301 (0%)]	Loss: 1.496344
INFO:root:Train Epoch: 3 [0/301 (0%)]	Loss: 1.597143
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 2 |, is 1.0674165487289429
INFO:root:@@@@@@@@ Working on client (global-index): 129, which 27-th user in the current round
INFO:root:Effective lr in FL round: 2 is 0.019960000000000002
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 1.998961
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.729796
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.547232
INFO:root:Accuracy of plane : 49.90 %
INFO:root:Accuracy of   car : 66.90 %
INFO:root:Accuracy of  bird : 71.30 %
INFO:root:Accuracy of   cat : 30.80 %
INFO:root:Accuracy of  deer : 71.30 %
INFO:root:Accuracy of   dog : 73.50 %
INFO:root:Accuracy of  frog : 89.50 %
INFO:root:Accuracy of horse : 85.00 %
INFO:root:Accuracy of  ship : 75.80 %
INFO:root:Accuracy of truck : 90.00 %
INFO:root:
Test set: Average loss: 0.0018, Accuracy: 7040/10000 (70.40%)

INFO:root:#### Targetted Accuracy of truck : 97.96 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 2 |, is 1.9695687294006348
INFO:root:@@@@@@@@ Working on client (global-index): 46, which 28-th user in the current round
INFO:root:Effective lr in FL round: 2 is 0.019960000000000002
INFO:root:Train Epoch: 1 [0/387 (0%)]	Loss: 1.643636
INFO:root:Train Epoch: 2 [0/387 (0%)]	Loss: 1.565284
INFO:root:Train Epoch: 3 [0/387 (0%)]	Loss: 1.614190
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 2 |, is 1.6458500623703003
INFO:root:@@@@@@@@ Working on client (global-index): 65, which 29-th user in the current round
INFO:root:Effective lr in FL round: 2 is 0.019960000000000002
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 1.842432
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.690038
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.697052
INFO:root:Accuracy of plane : 56.30 %
INFO:root:Accuracy of   car : 72.20 %
INFO:root:Accuracy of  bird : 77.20 %
INFO:root:Accuracy of   cat : 54.00 %
INFO:root:Accuracy of  deer : 67.60 %
INFO:root:Accuracy of   dog : 66.10 %
INFO:root:Accuracy of  frog : 72.20 %
INFO:root:Accuracy of horse : 82.00 %
INFO:root:Accuracy of  ship : 95.50 %
INFO:root:Accuracy of truck : 67.50 %
INFO:root:
Test set: Average loss: 0.0018, Accuracy: 7106/10000 (71.06%)

INFO:root:#### Targetted Accuracy of truck : 81.63 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 2 |, is 2.0249836444854736
INFO:root:GET_VGG_MODEL: Fetch vgg9
[Soft-filter] predicted suspicious set is:  [122, 96, 121]
Total computation time of the 1st layer is: 1.871826171875
[Hard-filter] predicted suspicious set is:  [120]
Total computation time of the 2nd layer is: 333.8623046875
[Final-result] predicted suspicious set is: [122, 96, 121]
verifier: 11, true positive: 1.0, true negative: 0.75, false positive: 0.25

predict honest: [30, 120, 135]

predict attacker: [122, 96, 121]

true attacker: [96, 121]

------------------------------------------------------------------------------------
epsilon_1:  0.48911725074649903
[Soft-filter] predicted suspicious set is:  [96, 99, 121]
Total computation time of the 1st layer is: 2.626953125
[Hard-filter] predicted suspicious set is:  [96, 99, 121]
Total computation time of the 2nd layer is: 338.10107421875
[Final-result] predicted suspicious set is: [96, 99, 121]
verifier: 12, true positive: 1.0, true negative: 1.0, false positive: 0.0

predict honest: [149, 126, 46]

predict attacker: [96, 99, 121]

true attacker: [96, 99, 121]

------------------------------------------------------------------------------------
epsilon_1:  0.35360161973174764
[Soft-filter] predicted suspicious set is:  [5, 14, 120]
Total computation time of the 1st layer is: 1.3798828125
[Hard-filter] predicted suspicious set is:  [5, 14, 30]
Total computation time of the 2nd layer is: 327.68359375
[Final-result] predicted suspicious set is: [5, 14, 120]
verifier: 13, true positive: 1.0, true negative: 0.75, false positive: 0.25

predict honest: [69, 77, 30]

predict attacker: [5, 14, 120]

true attacker: [5, 14]

------------------------------------------------------------------------------------
epsilon_1:  0.5
[Soft-filter] predicted suspicious set is:  [5, 35, 14, 34]
Total computation time of the 1st layer is: 1.368896484375
[Hard-filter] predicted suspicious set is:  [5, 35, 14, 34]
Total computation time of the 2nd layer is: 332.1591796875
[Final-result] predicted suspicious set is: [5, 35, 14, 34]
verifier: 14, true positive: 1.0, true negative: 1.0, false positive: 0.0

predict honest: [125, 126]

predict attacker: [5, 35, 14, 34]

true attacker: [5, 35, 14, 34]

------------------------------------------------------------------------------------
Flr: 1, number verifier: 15, clients/verifier: 6, attacked verifier: 4

Flr: 1, true positive: 1.0, true negative: 0.44999999999999996, false positive: 0.55

Flr: 1, honest client after all verify: [125, 77, 131, 23, 45, 30, 80, 135, 36]
Flr: 1, attackers: [78, 65, 96, 5, 121, 34, 99, 35, 14, 113]
Flr: 1, number not verify: 3
num_data_points:  [276, 350, 305, 399, 651, 247, 339, 212, 336, 600, 602, 301, 600, 293, 334, 337, 600, 600, 600, 186, 246, 600, 294, 343, 276, 336, 301, 600, 387, 600]
total_num_dps_per_round: 12151
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
epsilon_1:  0.39277201573686144
[Soft-filter] predicted suspicious set is:  [90, 109, 42]
Total computation time of the 1st layer is: 1.922607421875
[Hard-filter] predicted suspicious set is:  [90, 42, 72]
Total computation time of the 2nd layer is: 329.19482421875
[Final-result] predicted suspicious set is: [90, 109, 42]
verifier: 0, true positive: 0.6666666666666666, true negative: 0.6666666666666667, false positive: 0.3333333333333333

predict honest: [149, 27, 72]

predict attacker: [90, 109, 42]

true attacker: [90, 42, 72]

------------------------------------------------------------------------------------
epsilon_1:  0.45812468337605317
[Soft-filter] predicted suspicious set is:  [90, 109, 129]
Total computation time of the 1st layer is: 1.336669921875
[Hard-filter] predicted suspicious set is:  [109]
Total computation time of the 2nd layer is: 186.361572265625
[Final-result] predicted suspicious set is: [90, 109, 129]
verifier: 1, true positive: 1.0, true negative: 0.75, false positive: 0.25

predict honest: [46, 115, 32]

predict attacker: [90, 109, 129]

true attacker: [90, 129]

------------------------------------------------------------------------------------
epsilon_1:  0.4400975376415583
[Soft-filter] predicted suspicious set is:  [85, 105, 143]
Total computation time of the 1st layer is: 1.358642578125
[Hard-filter] predicted suspicious set is:  [45, 142, 85]
Total computation time of the 2nd layer is: 186.6669921875
[Final-result] predicted suspicious set is: [85, 105, 143]
verifier: 2, true positive: 1.0, true negative: 0.5, false positive: 0.5

predict honest: [45, 111, 142]

predict attacker: [85, 105, 143]

true attacker: []

------------------------------------------------------------------------------------
epsilon_1:  0.5
[Soft-filter] predicted suspicious set is:  [43, 42, 122, 72]
Total computation time of the 1st layer is: 1.569580078125
[Hard-filter] predicted suspicious set is:  [42, 122, 72]
Total computation time of the 2nd layer is: 215.443115234375
[Final-result] predicted suspicious set is: [43, 42, 122, 72]
verifier: 3, true positive: 1.0, true negative: 0.5, false positive: 0.5

predict honest: [146, 80]

predict attacker: [43, 42, 122, 72]

true attacker: [42, 72]

------------------------------------------------------------------------------------
epsilon_1:  0.5
[Soft-filter] predicted suspicious set is:  [72, 129, 85, 109]
Total computation time of the 1st layer is: 1.327880859375
[Hard-filter] predicted suspicious set is:  [109]
Total computation time of the 2nd layer is: 188.241455078125
[Final-result] predicted suspicious set is: [72, 129, 85, 109]
verifier: 4, true positive: 1.0, true negative: 0.5, false positive: 0.5

predict honest: [0, 45]

predict attacker: [72, 129, 85, 109]

true attacker: [72, 129]

------------------------------------------------------------------------------------
epsilon_1:  0.3702351058884074
[Soft-filter] predicted suspicious set is:  [72, 144, 122]
Total computation time of the 1st layer is: 1.291259765625
[Hard-filter] predicted suspicious set is:  [72, 144, 122]
Total computation time of the 2nd layer is: 194.633056640625
[Final-result] predicted suspicious set is: [72, 144, 122]
verifier: 5, true positive: 1.0, true negative: 0.75, false positive: 0.25

predict honest: [70, 97, 46]

predict attacker: [72, 144, 122]

true attacker: [72, 144]

------------------------------------------------------------------------------------
epsilon_1:  0.3965586098650674
[Soft-filter] predicted suspicious set is:  [115, 90, 72]
Total computation time of the 1st layer is: 1.32421875
[Hard-filter] predicted suspicious set is:  [97, 90, 72]
Total computation time of the 2nd layer is: 193.115478515625
INFO:root:GET_VGG_MODEL: Fetch vgg9
INFO:root:===> ND `|w_avg-w_g|` in local epoch: 0 | FL round: 2 |, is 0.0
INFO:root:Measuring the accuracy of the averaged global model, FL round: 2 ...
INFO:root:Accuracy of plane : 88.30 %
INFO:root:Accuracy of   car : 98.30 %
INFO:root:Accuracy of  bird : 62.10 %
INFO:root:Accuracy of   cat : 34.00 %
INFO:root:Accuracy of  deer : 79.40 %
INFO:root:Accuracy of   dog : 85.50 %
INFO:root:Accuracy of  frog : 96.10 %
INFO:root:Accuracy of horse : 65.60 %
INFO:root:Accuracy of  ship : 84.00 %
INFO:root:Accuracy of truck : 70.10 %
INFO:root:
Test set: Average loss: 0.0017, Accuracy: 7634/10000 (76.34%)

INFO:root:#### Targetted Accuracy of truck : 3.06 %
INFO:root:Selected Attackers in FL iteration-3: [54, 14, 132, 3, 90, 113, 123, 144]
INFO:root:################## Starting fl round: 3
INFO:root:@@@@@@@@ Working on client (global-index): 6, which 0-th user in the current round
INFO:root:Effective lr in FL round: 3 is 0.01992008
INFO:root:Train Epoch: 1 [0/481 (0%)]	Loss: 1.632801
INFO:root:Train Epoch: 2 [0/481 (0%)]	Loss: 1.620337
INFO:root:Train Epoch: 3 [0/481 (0%)]	Loss: 1.583570
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 3 |, is 1.5734144449234009
INFO:root:@@@@@@@@ Working on client (global-index): 54, which 1-th user in the current round
INFO:root:Effective lr in FL round: 3 is 0.01992008
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 1.859358
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.687730
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.596411
INFO:root:Accuracy of plane : 71.40 %
INFO:root:Accuracy of   car : 78.20 %
INFO:root:Accuracy of  bird : 42.70 %
INFO:root:Accuracy of   cat : 81.90 %
INFO:root:Accuracy of  deer : 75.00 %
INFO:root:Accuracy of   dog : 46.30 %
INFO:root:Accuracy of  frog : 83.20 %
INFO:root:Accuracy of horse : 70.10 %
INFO:root:Accuracy of  ship : 82.30 %
INFO:root:Accuracy of truck : 92.20 %
INFO:root:
Test set: Average loss: 0.0017, Accuracy: 7233/10000 (72.33%)

INFO:root:#### Targetted Accuracy of truck : 91.84 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 3 |, is 2.029276132583618
INFO:root:@@@@@@@@ Working on client (global-index): 80, which 2-th user in the current round
INFO:root:Effective lr in FL round: 3 is 0.01992008
INFO:root:Train Epoch: 1 [0/212 (0%)]	Loss: 1.552239
INFO:root:Train Epoch: 2 [0/212 (0%)]	Loss: 1.538834
INFO:root:Train Epoch: 3 [0/212 (0%)]	Loss: 1.551400
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 3 |, is 0.802210807800293
INFO:root:@@@@@@@@ Working on client (global-index): 94, which 3-th user in the current round
INFO:root:Effective lr in FL round: 3 is 0.01992008
INFO:root:Train Epoch: 1 [0/392 (0%)]	Loss: 1.569063
INFO:root:Train Epoch: 2 [0/392 (0%)]	Loss: 1.528106
INFO:root:Train Epoch: 3 [0/392 (0%)]	Loss: 1.526352
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 3 |, is 0.9200586676597595
INFO:root:@@@@@@@@ Working on client (global-index): 112, which 4-th user in the current round
INFO:root:Effective lr in FL round: 3 is 0.01992008
INFO:root:Train Epoch: 1 [0/352 (0%)]	Loss: 1.658946
INFO:root:Train Epoch: 2 [0/352 (0%)]	Loss: 1.577139
INFO:root:Train Epoch: 3 [0/352 (0%)]	Loss: 1.461744
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 3 |, is 0.9837377667427063
INFO:root:@@@@@@@@ Working on client (global-index): 14, which 5-th user in the current round
INFO:root:Effective lr in FL round: 3 is 0.01992008
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 1.846837
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.685580
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.655724
INFO:root:Accuracy of plane : 55.20 %
INFO:root:Accuracy of   car : 56.60 %
INFO:root:Accuracy of  bird : 69.30 %
INFO:root:Accuracy of   cat : 50.70 %
INFO:root:Accuracy of  deer : 71.60 %
INFO:root:Accuracy of   dog : 69.50 %
INFO:root:Accuracy of  frog : 87.60 %
INFO:root:Accuracy of horse : 71.00 %
INFO:root:Accuracy of  ship : 92.10 %
INFO:root:Accuracy of truck : 87.20 %
INFO:root:
Test set: Average loss: 0.0018, Accuracy: 7108/10000 (71.08%)

INFO:root:#### Targetted Accuracy of truck : 94.90 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 3 |, is 2.132539987564087
INFO:root:@@@@@@@@ Working on client (global-index): 63, which 6-th user in the current round
INFO:root:Effective lr in FL round: 3 is 0.01992008
INFO:root:Train Epoch: 1 [0/378 (0%)]	Loss: 1.739930
INFO:root:Train Epoch: 2 [0/378 (0%)]	Loss: 1.555648
INFO:root:Train Epoch: 3 [0/378 (0%)]	Loss: 1.580373
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 3 |, is 1.0600860118865967
INFO:root:@@@@@@@@ Working on client (global-index): 119, which 7-th user in the current round
INFO:root:Effective lr in FL round: 3 is 0.01992008
INFO:root:Train Epoch: 1 [0/234 (0%)]	Loss: 1.703486
INFO:root:Train Epoch: 2 [0/234 (0%)]	Loss: 1.582978
INFO:root:Train Epoch: 3 [0/234 (0%)]	Loss: 1.500285
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 3 |, is 1.19965398311615
INFO:root:@@@@@@@@ Working on client (global-index): 139, which 8-th user in the current round
INFO:root:Effective lr in FL round: 3 is 0.01992008
INFO:root:Train Epoch: 1 [0/312 (0%)]	Loss: 1.707992
INFO:root:Train Epoch: 2 [0/312 (0%)]	Loss: 1.564335
INFO:root:Train Epoch: 3 [0/312 (0%)]	Loss: 1.532280
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 3 |, is 0.9713385105133057
INFO:root:@@@@@@@@ Working on client (global-index): 92, which 9-th user in the current round
INFO:root:Effective lr in FL round: 3 is 0.01992008
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 1.627988
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.565825
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.472192
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 3 |, is 1.5732953548431396
INFO:root:@@@@@@@@ Working on client (global-index): 128, which 10-th user in the current round
INFO:root:Effective lr in FL round: 3 is 0.01992008
INFO:root:Train Epoch: 1 [0/111 (0%)]	Loss: 1.753920
INFO:root:Train Epoch: 2 [0/111 (0%)]	Loss: 1.625461
INFO:root:Train Epoch: 3 [0/111 (0%)]	Loss: 1.522548
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 3 |, is 0.6339052319526672
INFO:root:@@@@@@@@ Working on client (global-index): 57, which 11-th user in the current round
INFO:root:Effective lr in FL round: 3 is 0.01992008
INFO:root:Train Epoch: 1 [0/686 (0%)]	Loss: 1.850741
INFO:root:Train Epoch: 2 [0/686 (0%)]	Loss: 1.616708
INFO:root:Train Epoch: 3 [0/686 (0%)]	Loss: 1.481139
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 3 |, is 1.761854887008667
INFO:root:@@@@@@@@ Working on client (global-index): 114, which 12-th user in the current round
INFO:root:Effective lr in FL round: 3 is 0.01992008
INFO:root:Train Epoch: 1 [0/245 (0%)]	Loss: 1.636358
INFO:root:Train Epoch: 2 [0/245 (0%)]	Loss: 1.516101
INFO:root:Train Epoch: 3 [0/245 (0%)]	Loss: 1.549256
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 3 |, is 0.8233963847160339
INFO:root:@@@@@@@@ Working on client (global-index): 25, which 13-th user in the current round
INFO:root:Effective lr in FL round: 3 is 0.01992008
INFO:root:Train Epoch: 1 [0/602 (0%)]	Loss: 1.611872
INFO:root:Train Epoch: 2 [0/602 (0%)]	Loss: 1.521549
INFO:root:Train Epoch: 3 [0/602 (0%)]	Loss: 1.560249
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 3 |, is 1.7171276807785034
INFO:root:@@@@@@@@ Working on client (global-index): 23, which 14-th user in the current round
INFO:root:Effective lr in FL round: 3 is 0.01992008
INFO:root:Train Epoch: 1 [0/335 (0%)]	Loss: 1.661826
INFO:root:Train Epoch: 2 [0/335 (0%)]	Loss: 1.568952
INFO:root:Train Epoch: 3 [0/335 (0%)]	Loss: 1.550547
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 3 |, is 1.0512261390686035
INFO:root:@@@@@@@@ Working on client (global-index): 20, which 15-th user in the current round
INFO:root:Effective lr in FL round: 3 is 0.01992008
INFO:root:Train Epoch: 1 [0/264 (0%)]	Loss: 1.532316
INFO:root:Train Epoch: 2 [0/264 (0%)]	Loss: 1.525673
INFO:root:Train Epoch: 3 [0/264 (0%)]	Loss: 1.485129
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 3 |, is 0.8648373484611511
INFO:root:@@@@@@@@ Working on client (global-index): 132, which 16-th user in the current round
INFO:root:Effective lr in FL round: 3 is 0.01992008
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 2.046936
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.700087
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.781049
INFO:root:Accuracy of plane : 8.60 %
INFO:root:Accuracy of   car : 32.60 %
INFO:root:Accuracy of  bird : 40.80 %
INFO:root:Accuracy of   cat : 50.90 %
INFO:root:Accuracy of  deer : 69.00 %
INFO:root:Accuracy of   dog : 70.50 %
INFO:root:Accuracy of  frog : 90.80 %
INFO:root:Accuracy of horse : 89.50 %
INFO:root:Accuracy of  ship : 77.10 %
INFO:root:Accuracy of truck : 94.40 %
INFO:root:
Test set: Average loss: 0.0018, Accuracy: 6242/10000 (62.42%)

INFO:root:#### Targetted Accuracy of truck : 96.94 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 3 |, is 2.1215174198150635
INFO:root:@@@@@@@@ Working on client (global-index): 3, which 17-th user in the current round
INFO:root:Effective lr in FL round: 3 is 0.01992008
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 1.976051
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.768573
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.724153
INFO:root:Accuracy of plane : 9.50 %
INFO:root:Accuracy of   car : 81.50 %
INFO:root:Accuracy of  bird : 46.60 %
INFO:root:Accuracy of   cat : 13.60 %
INFO:root:Accuracy of  deer : 25.60 %
INFO:root:Accuracy of   dog : 72.80 %
INFO:root:Accuracy of  frog : 89.90 %
INFO:root:Accuracy of horse : 74.80 %
INFO:root:Accuracy of  ship : 76.90 %
INFO:root:Accuracy of truck : 86.10 %
INFO:root:
Test set: Average loss: 0.0019, Accuracy: 5773/10000 (57.73%)

INFO:root:#### Targetted Accuracy of truck : 93.88 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 3 |, is 2.2976276874542236
INFO:root:@@@@@@@@ Working on client (global-index): 88, which 18-th user in the current round
INFO:root:Effective lr in FL round: 3 is 0.01992008
INFO:root:Train Epoch: 1 [0/379 (0%)]	Loss: 1.554484
INFO:root:Train Epoch: 2 [0/379 (0%)]	Loss: 1.660357
INFO:root:Train Epoch: 3 [0/379 (0%)]	Loss: 1.552313
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 3 |, is 1.192823886871338
INFO:root:@@@@@@@@ Working on client (global-index): 85, which 19-th user in the current round
INFO:root:Effective lr in FL round: 3 is 0.01992008
INFO:root:Train Epoch: 1 [0/337 (0%)]	Loss: 1.845305
INFO:root:Train Epoch: 2 [0/337 (0%)]	Loss: 1.720566
INFO:root:Train Epoch: 3 [0/337 (0%)]	Loss: 1.578027
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 3 |, is 1.2179036140441895
INFO:root:@@@@@@@@ Working on client (global-index): 124, which 20-th user in the current round
INFO:root:Effective lr in FL round: 3 is 0.01992008
INFO:root:Train Epoch: 1 [0/204 (0%)]	Loss: 1.726060
INFO:root:Train Epoch: 2 [0/204 (0%)]	Loss: 1.649114
INFO:root:Train Epoch: 3 [0/204 (0%)]	Loss: 1.544211
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 3 |, is 0.9327212572097778
INFO:root:@@@@@@@@ Working on client (global-index): 116, which 21-th user in the current round
INFO:root:Effective lr in FL round: 3 is 0.01992008
INFO:root:Train Epoch: 1 [0/422 (0%)]	Loss: 1.720317
INFO:root:Train Epoch: 2 [0/422 (0%)]	Loss: 1.585807
INFO:root:Train Epoch: 3 [0/422 (0%)]	Loss: 1.523822
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 3 |, is 1.4265704154968262
INFO:root:@@@@@@@@ Working on client (global-index): 38, which 22-th user in the current round
INFO:root:Effective lr in FL round: 3 is 0.01992008
INFO:root:Train Epoch: 1 [0/394 (0%)]	Loss: 1.633423
INFO:root:Train Epoch: 2 [0/394 (0%)]	Loss: 1.546948
INFO:root:Train Epoch: 3 [0/394 (0%)]	Loss: 1.526260
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 3 |, is 1.155140995979309
INFO:root:@@@@@@@@ Working on client (global-index): 90, which 23-th user in the current round
INFO:root:Effective lr in FL round: 3 is 0.01992008
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 2.029200
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.648887
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.795927
INFO:root:Accuracy of plane : 6.40 %
INFO:root:Accuracy of   car : 23.30 %
INFO:root:Accuracy of  bird : 36.40 %
INFO:root:Accuracy of   cat : 34.80 %
INFO:root:Accuracy of  deer : 60.20 %
INFO:root:Accuracy of   dog : 44.10 %
INFO:root:Accuracy of  frog : 79.20 %
INFO:root:Accuracy of horse : 61.30 %
INFO:root:Accuracy of  ship : 58.50 %
INFO:root:Accuracy of truck : 98.70 %
INFO:root:
Test set: Average loss: 0.0020, Accuracy: 5029/10000 (50.29%)

INFO:root:#### Targetted Accuracy of truck : 100.00 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 3 |, is 2.135284900665283
INFO:root:@@@@@@@@ Working on client (global-index): 113, which 24-th user in the current round
INFO:root:Effective lr in FL round: 3 is 0.01992008
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 2.082327
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.668013
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.748143
INFO:root:Accuracy of plane : 53.40 %
INFO:root:Accuracy of   car : 76.80 %
INFO:root:Accuracy of  bird : 39.00 %
INFO:root:Accuracy of   cat : 45.70 %
INFO:root:Accuracy of  deer : 50.30 %
INFO:root:Accuracy of   dog : 63.30 %
INFO:root:Accuracy of  frog : 96.90 %
INFO:root:Accuracy of horse : 86.30 %
INFO:root:Accuracy of  ship : 77.10 %
INFO:root:Accuracy of truck : 79.70 %
INFO:root:
Test set: Average loss: 0.0018, Accuracy: 6685/10000 (66.85%)

INFO:root:#### Targetted Accuracy of truck : 95.92 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 3 |, is 2.1632449626922607
INFO:root:@@@@@@@@ Working on client (global-index): 9, which 25-th user in the current round
INFO:root:Effective lr in FL round: 3 is 0.01992008
INFO:root:Train Epoch: 1 [0/337 (0%)]	Loss: 1.498784
INFO:root:Train Epoch: 2 [0/337 (0%)]	Loss: 1.628411
INFO:root:Train Epoch: 3 [0/337 (0%)]	Loss: 1.506895
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 3 |, is 1.0452018976211548
INFO:root:@@@@@@@@ Working on client (global-index): 18, which 26-th user in the current round
INFO:root:Effective lr in FL round: 3 is 0.01992008
INFO:root:Train Epoch: 1 [0/409 (0%)]	Loss: 1.760835
INFO:root:Train Epoch: 2 [0/409 (0%)]	Loss: 1.738514
INFO:root:Train Epoch: 3 [0/409 (0%)]	Loss: 1.581982
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 3 |, is 1.3538422584533691
INFO:root:@@@@@@@@ Working on client (global-index): 123, which 27-th user in the current round
INFO:root:Effective lr in FL round: 3 is 0.01992008
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 1.953941
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.662229
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.749532
INFO:root:Accuracy of plane : 60.00 %
INFO:root:Accuracy of   car : 74.70 %
INFO:root:Accuracy of  bird : 66.00 %
INFO:root:Accuracy of   cat : 53.70 %
INFO:root:Accuracy of  deer : 73.00 %
INFO:root:Accuracy of   dog : 18.20 %
INFO:root:Accuracy of  frog : 90.60 %
INFO:root:Accuracy of horse : 79.80 %
INFO:root:Accuracy of  ship : 78.20 %
INFO:root:Accuracy of truck : 86.40 %
INFO:root:
Test set: Average loss: 0.0018, Accuracy: 6806/10000 (68.06%)

INFO:root:#### Targetted Accuracy of truck : 99.49 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 3 |, is 2.17134428024292
INFO:root:@@@@@@@@ Working on client (global-index): 76, which 28-th user in the current round
INFO:root:Effective lr in FL round: 3 is 0.01992008
INFO:root:Train Epoch: 1 [0/351 (0%)]	Loss: 1.610926
INFO:root:Train Epoch: 2 [0/351 (0%)]	Loss: 1.561451
INFO:root:Train Epoch: 3 [0/351 (0%)]	Loss: 1.610732
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 3 |, is 1.0656386613845825
INFO:root:@@@@@@@@ Working on client (global-index): 144, which 29-th user in the current round
INFO:root:Effective lr in FL round: 3 is 0.01992008
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 1.934847
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.598214
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.631310
INFO:root:Accuracy of plane : 68.60 %
INFO:root:Accuracy of   car : 78.50 %
INFO:root:Accuracy of  bird : 55.20 %
INFO:root:Accuracy of   cat : 65.70 %
INFO:root:Accuracy of  deer : 82.40 %
INFO:root:Accuracy of   dog : 0.50 %
INFO:root:Accuracy of  frog : 82.70 %
INFO:root:Accuracy of horse : 80.40 %
INFO:root:Accuracy of  ship : 73.90 %
INFO:root:Accuracy of truck : 88.80 %
INFO:root:
Test set: Average loss: 0.0018, Accuracy: 6767/10000 (67.67%)

INFO:root:#### Targetted Accuracy of truck : 96.43 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 3 |, is 2.1148788928985596
INFO:root:GET_VGG_MODEL: Fetch vgg9
[Final-result] predicted suspicious set is: [115, 90, 72]
verifier: 6, true positive: 1.0, true negative: 0.75, false positive: 0.25

predict honest: [70, 27, 97]

predict attacker: [115, 90, 72]

true attacker: [90, 72]

------------------------------------------------------------------------------------
epsilon_1:  0.2010777972016824
[Soft-filter] predicted suspicious set is:  [122, 0, 65]
Total computation time of the 1st layer is: 1.4052734375
[Hard-filter] predicted suspicious set is:  [122, 65]
Total computation time of the 2nd layer is: 227.917236328125
[Final-result] predicted suspicious set is: [122, 0, 65]
verifier: 7, true positive: 1.0, true negative: 0.6, false positive: 0.4

predict honest: [80, 45, 46]

predict attacker: [122, 0, 65]

true attacker: [65]

------------------------------------------------------------------------------------
epsilon_1:  0.46978150025589505
[Soft-filter] predicted suspicious set is:  [90, 85, 35]
Total computation time of the 1st layer is: 1.62841796875
[Hard-filter] predicted suspicious set is:  [90, 35]
Total computation time of the 2nd layer is: 188.87744140625
[Final-result] predicted suspicious set is: [90, 85, 35]
verifier: 8, true positive: 1.0, true negative: 0.75, false positive: 0.25

predict honest: [80, 32, 45]

predict attacker: [90, 85, 35]

true attacker: [90, 35]

------------------------------------------------------------------------------------
epsilon_1:  0.5
[Soft-filter] predicted suspicious set is:  [42, 122, 144]
Total computation time of the 1st layer is: 1.484375
[Hard-filter] predicted suspicious set is:  [70, 97]
Total computation time of the 2nd layer is: 188.927001953125
[Final-result] predicted suspicious set is: [42, 122, 144]
verifier: 9, true positive: 1.0, true negative: 0.75, false positive: 0.25

predict honest: [70, 32, 97]

predict attacker: [42, 122, 144]

true attacker: [42, 144]

------------------------------------------------------------------------------------
epsilon_1:  0.46454152736690596
[Soft-filter] predicted suspicious set is:  [115, 35, 122]
Total computation time of the 1st layer is: 2.276611328125
[Hard-filter] predicted suspicious set is:  [115, 35, 122, 27]
Total computation time of the 2nd layer is: 193.981689453125
[Final-result] predicted suspicious set is: [115, 35, 122]
verifier: 10, true positive: 1.0, true negative: 0.6, false positive: 0.4

predict honest: [111, 25, 27]

predict attacker: [115, 35, 122]

true attacker: [35]

------------------------------------------------------------------------------------
epsilon_1:  0.5
[Soft-filter] predicted suspicious set is:  [129, 89, 90]
Total computation time of the 1st layer is: 1.371337890625
[Hard-filter] predicted suspicious set is:  [129, 89, 90]
Total computation time of the 2nd layer is: 193.6923828125
[Final-result] predicted suspicious set is: [129, 89, 90]
verifier: 11, true positive: 1.0, true negative: 1.0, false positive: 0.0

predict honest: [111, 47, 146]

predict attacker: [129, 89, 90]

true attacker: [129, 89, 90]

------------------------------------------------------------------------------------
epsilon_1:  0.5
[Soft-filter] predicted suspicious set is:  [109, 129, 43, 90, 144]
Total computation time of the 1st layer is: 1.466796875
[Hard-filter] predicted suspicious set is:  [105, 129, 90, 144]
Total computation time of the 2nd layer is: 190.546875
[Final-result] predicted suspicious set is: [109, 129, 43, 90, 144]
verifier: 12, true positive: 1.0, true negative: 0.33333333333333337, false positive: 0.6666666666666666

predict honest: [105]

predict attacker: [109, 129, 43, 90, 144]

true attacker: [129, 90, 144]

------------------------------------------------------------------------------------
epsilon_1:  0.5
[Soft-filter] predicted suspicious set is:  [72, 65, 129, 85]
Total computation time of the 1st layer is: 1.447998046875
[Hard-filter] predicted suspicious set is:  [72, 65, 129]
Total computation time of the 2nd layer is: 191.257080078125
[Final-result] predicted suspicious set is: [72, 65, 129, 85]
verifier: 13, true positive: 1.0, true negative: 0.6666666666666667, false positive: 0.3333333333333333

predict honest: [46, 142]

predict attacker: [72, 65, 129, 85]

true attacker: [72, 65, 129]

------------------------------------------------------------------------------------
epsilon_1:  0.396446135525074
[Soft-filter] predicted suspicious set is:  [72, 105, 143]
Total computation time of the 1st layer is: 1.374267578125
[Hard-filter] predicted suspicious set is:  [149]
Total computation time of the 2nd layer is: 189.9267578125
[Final-result] predicted suspicious set is: [72, 105, 143]
verifier: 14, true positive: 1.0, true negative: 0.6, false positive: 0.4

predict honest: [47, 0, 149]

predict attacker: [72, 105, 143]

true attacker: [72]

------------------------------------------------------------------------------------
Flr: 2, number verifier: 15, clients/verifier: 6, attacked verifier: 3

Flr: 2, true positive: 1.0, true negative: 0.5909090909090908, false positive: 0.4090909090909091

Flr: 2, honest client after all verify: [32, 142, 45, 80, 70, 25, 97, 111, 47, 27, 146, 149, 46]
Flr: 2, attackers: [42, 72, 89, 144, 35, 90, 129, 65]
Flr: 2, number not verify: 1
num_data_points:  [481, 600, 212, 392, 352, 600, 378, 234, 312, 600, 111, 686, 245, 602, 335, 264, 600, 600, 379, 337, 204, 422, 394, 600, 600, 337, 409, 600, 351, 600]
total_num_dps_per_round: 12837
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
epsilon_1:  0.5
[Soft-filter] predicted suspicious set is:  [85, 124, 139, 57]
Total computation time of the 1st layer is: 2.028564453125
[Hard-filter] predicted suspicious set is:  [57]
Total computation time of the 2nd layer is: 182.919921875
[Final-result] predicted suspicious set is: [85, 124, 139, 57]
verifier: 0, true positive: 1.0, true negative: 0.33333333333333337, false positive: 0.6666666666666666

predict honest: [114, 112]

predict attacker: [85, 124, 139, 57]

true attacker: []

------------------------------------------------------------------------------------
epsilon_1:  0.5
[Soft-filter] predicted suspicious set is:  [85, 57, 20, 18, 123]
Total computation time of the 1st layer is: 1.3173828125
[Hard-filter] predicted suspicious set is:  [85, 94, 123]
Total computation time of the 2nd layer is: 181.074462890625
[Final-result] predicted suspicious set is: [85, 57, 20, 18, 123]
verifier: 1, true positive: 1.0, true negative: 0.19999999999999996, false positive: 0.8

predict honest: [94]

predict attacker: [85, 57, 20, 18, 123]

INFO:root:GET_VGG_MODEL: Fetch vgg9
INFO:root:===> ND `|w_avg-w_g|` in local epoch: 0 | FL round: 3 |, is 0.0
INFO:root:Measuring the accuracy of the averaged global model, FL round: 3 ...
INFO:root:Accuracy of plane : 94.30 %
INFO:root:Accuracy of   car : 96.70 %
INFO:root:Accuracy of  bird : 71.30 %
INFO:root:Accuracy of   cat : 15.00 %
INFO:root:Accuracy of  deer : 73.50 %
INFO:root:Accuracy of   dog : 92.10 %
INFO:root:Accuracy of  frog : 86.60 %
INFO:root:Accuracy of horse : 72.10 %
INFO:root:Accuracy of  ship : 83.00 %
INFO:root:Accuracy of truck : 71.90 %
INFO:root:
Test set: Average loss: 0.0017, Accuracy: 7565/10000 (75.65%)

INFO:root:#### Targetted Accuracy of truck : 0.51 %
INFO:root:Selected Attackers in FL iteration-4: [42, 129, 144, 5, 44, 14, 99, 2]
INFO:root:################## Starting fl round: 4
INFO:root:@@@@@@@@ Working on client (global-index): 46, which 0-th user in the current round
INFO:root:Effective lr in FL round: 4 is 0.01988023984
INFO:root:Train Epoch: 1 [0/387 (0%)]	Loss: 1.759548
INFO:root:Train Epoch: 2 [0/387 (0%)]	Loss: 1.603672
INFO:root:Train Epoch: 3 [0/387 (0%)]	Loss: 1.584682
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 4 |, is 1.4602309465408325
INFO:root:@@@@@@@@ Working on client (global-index): 42, which 1-th user in the current round
INFO:root:Effective lr in FL round: 4 is 0.01988023984
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 2.110191
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.653666
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.692860
INFO:root:Accuracy of plane : 22.00 %
INFO:root:Accuracy of   car : 71.40 %
INFO:root:Accuracy of  bird : 47.60 %
INFO:root:Accuracy of   cat : 48.90 %
INFO:root:Accuracy of  deer : 77.00 %
INFO:root:Accuracy of   dog : 83.10 %
INFO:root:Accuracy of  frog : 88.80 %
INFO:root:Accuracy of horse : 62.30 %
INFO:root:Accuracy of  ship : 93.40 %
INFO:root:Accuracy of truck : 88.50 %
INFO:root:
Test set: Average loss: 0.0018, Accuracy: 6830/10000 (68.30%)

INFO:root:#### Targetted Accuracy of truck : 93.88 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 4 |, is 2.318737030029297
true attacker: [123]

------------------------------------------------------------------------------------
epsilon_1:  0.28445361988288603
[Soft-filter] predicted suspicious set is:  [23, 20, 92]
Total computation time of the 1st layer is: 1.3876953125
[Hard-filter] predicted suspicious set is:  [20]
Total computation time of the 2nd layer is: 180.88037109375
[Final-result] predicted suspicious set is: [23, 20, 92]
verifier: 2, true positive: 1.0, true negative: 0.5, false positive: 0.5

predict honest: [76, 80, 112]

predict attacker: [23, 20, 92]

true attacker: []

------------------------------------------------------------------------------------
epsilon_1:  0.38266242703953635
[Soft-filter] predicted suspicious set is:  [90, 139, 20]
Total computation time of the 1st layer is: 1.30126953125
[Hard-filter] predicted suspicious set is:  [94, 90, 76]
Total computation time of the 2nd layer is: 179.232421875
[Final-result] predicted suspicious set is: [90, 139, 20]
verifier: 3, true positive: 1.0, true negative: 0.6, false positive: 0.4

predict honest: [94, 128, 76]

predict attacker: [90, 139, 20]

true attacker: [90]

------------------------------------------------------------------------------------
epsilon_1:  0.5
[Soft-filter] predicted suspicious set is:  [18, 14, 132]
Total computation time of the 1st layer is: 1.85400390625
[Hard-filter] predicted suspicious set is:  [14, 132]
Total computation time of the 2nd layer is: 180.105224609375
[Final-result] predicted suspicious set is: [18, 14, 132]
verifier: 4, true positive: 1.0, true negative: 0.75, false positive: 0.25

predict honest: [38, 6, 63]

predict attacker: [18, 14, 132]

true attacker: [14, 132]

------------------------------------------------------------------------------------
epsilon_1:  0.5
[Soft-filter] predicted suspicious set is:  [132, 57, 3]
Total computation time of the 1st layer is: 1.501953125
[Hard-filter] predicted suspicious set is:  [132, 3]
Total computation time of the 2nd layer is: 179.22021484375
[Final-result] predicted suspicious set is: [132, 57, 3]
verifier: 5, true positive: 1.0, true negative: 0.75, false positive: 0.25

predict honest: [112, 38, 6]

predict attacker: [132, 57, 3]

true attacker: [132, 3]

------------------------------------------------------------------------------------
epsilon_1:  0.40601001084954336
[Soft-filter] predicted suspicious set is:  [113, 132, 124]
Total computation time of the 1st layer is: 1.35009765625
[Hard-filter] predicted suspicious set is:  [113, 132]
Total computation time of the 2nd layer is: 202.713134765625
[Final-result] predicted suspicious set is: [113, 132, 124]
verifier: 6, true positive: 1.0, true negative: 0.75, false positive: 0.25

predict honest: [92, 80, 38]

predict attacker: [113, 132, 124]

true attacker: [113, 132]

------------------------------------------------------------------------------------
epsilon_1:  0.5
[Soft-filter] predicted suspicious set is:  [123, 132, 57, 14, 18]
Total computation time of the 1st layer is: 1.965087890625
[Hard-filter] predicted suspicious set is:  [123, 132, 14]
Total computation time of the 2nd layer is: 195.322509765625
[Final-result] predicted suspicious set is: [123, 132, 57, 14, 18]
verifier: 7, true positive: 1.0, true negative: 0.33333333333333337, false positive: 0.6666666666666666

predict honest: [139]

predict attacker: [123, 132, 57, 14, 18]

true attacker: [123, 132, 14]

------------------------------------------------------------------------------------
epsilon_1:  0.5
[Soft-filter] predicted suspicious set is:  [113, 3, 123, 144, 132]
Total computation time of the 1st layer is: 1.73974609375
[Hard-filter] predicted suspicious set is:  [113, 3, 123, 144, 132]
Total computation time of the 2nd layer is: 185.193359375
[Final-result] predicted suspicious set is: [113, 3, 123, 144, 132]
verifier: 8, true positive: 1.0, true negative: 1.0, false positive: 0.0

predict honest: [119]

predict attacker: [113, 3, 123, 144, 132]

true attacker: [113, 3, 123, 144, 132]

------------------------------------------------------------------------------------
epsilon_1:  0.33522169038436955
[Soft-filter] predicted suspicious set is:  [124, 85, 113]
Total computation time of the 1st layer is: 1.944580078125
[Hard-filter] predicted suspicious set is:  [85, 9, 113]
Total computation time of the 2nd layer is: 199.09423828125
[Final-result] predicted suspicious set is: [124, 85, 113]
verifier: 9, true positive: 1.0, true negative: 0.6, false positive: 0.4

predict honest: [128, 119, 9]

predict attacker: [124, 85, 113]

true attacker: [113]

------------------------------------------------------------------------------------
epsilon_1:  0.24192274123076069
[Soft-filter] predicted suspicious set is:  [123, 119, 90]
Total computation time of the 1st layer is: 1.72509765625
[Hard-filter] predicted suspicious set is:  [123, 90]
Total computation time of the 2nd layer is: 195.2724609375
[Final-result] predicted suspicious set is: [123, 119, 90]
verifier: 10, true positive: 1.0, true negative: 0.75, false positive: 0.25

predict honest: [63, 9, 114]

predict attacker: [123, 119, 90]

true attacker: [123, 90]

------------------------------------------------------------------------------------
epsilon_1:  0.4443409443798266
[Soft-filter] predicted suspicious set is:  [132, 20, 57]
Total computation time of the 1st layer is: 1.679443359375
[Hard-filter] predicted suspicious set is:  [132]
Total computation time of the 2nd layer is: 206.1728515625
[Final-result] predicted suspicious set is: [132, 20, 57]
verifier: 11, true positive: 1.0, true negative: 0.6, false positive: 0.4

predict honest: [9, 119, 63]

predict attacker: [132, 20, 57]

true attacker: [132]

------------------------------------------------------------------------------------
epsilon_1:  0.35794002884389065
[Soft-filter] predicted suspicious set is:  [90, 139, 20]
Total computation time of the 1st layer is: 2.27734375
[Hard-filter] predicted suspicious set is:  [6, 76, 9, 139]
Total computation time of the 2nd layer is: 186.82958984375
[Final-result] predicted suspicious set is: [90, 139, 20]
verifier: 12, true positive: 1.0, true negative: 0.6, false positive: 0.4

predict honest: [6, 76, 9]

predict attacker: [90, 139, 20]

true attacker: [90]

------------------------------------------------------------------------------------
epsilon_1:  0.43122403545076127
[Soft-filter] predicted suspicious set is:  [85, 57, 23]
Total computation time of the 1st layer is: 1.761474609375
[Hard-filter] predicted suspicious set is:  [38, 85]
Total computation time of the 2nd layer is: 191.134521484375
[Final-result] predicted suspicious set is: [85, 57, 23]
verifier: 13, true positive: 1.0, true negative: 0.5, false positive: 0.5

predict honest: [139, 63, 38]

predict attacker: [85, 57, 23]

true attacker: []

------------------------------------------------------------------------------------
epsilon_1:  0.482432362703838
[Soft-filter] predicted suspicious set is:  [90, 57, 123]
Total computation time of the 1st layer is: 1.85400390625
[Hard-filter] predicted suspicious set is:  [90, 123]
Total computation time of the 2nd layer is: 192.54931640625
[Final-result] predicted suspicious set is: [90, 57, 123]
verifier: 14, true positive: 1.0, true negative: 0.75, false positive: 0.25

predict honest: [9, 80, 119]

predict attacker: [90, 57, 123]

true attacker: [90, 123]

------------------------------------------------------------------------------------
Flr: 3, number verifier: 15, clients/verifier: 6, attacked verifier: 2

Flr: 3, true positive: 1.0, true negative: 0.4545454545454546, false positive: 0.5454545454545454

Flr: 3, honest client after all verify: [6, 80, 94, 112, 63, 128, 114, 38, 9, 76]
Flr: 3, attackers: [54, 14, 132, 3, 90, 113, 123, 144]
Flr: 3, number not verify: 4
num_data_points:  [387, 600, 461, 181, 373, 394, 600, 340, 276, 275, 486, 133, 139, 352, 600, 339, 600, 111, 162, 600, 600, 331, 301, 343, 246, 294, 264, 600, 405, 600]
total_num_dps_per_round: 11393
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
INFO:root:@@@@@@@@ Working on client (global-index): 68, which 2-th user in the current round
INFO:root:Effective lr in FL round: 4 is 0.01988023984
INFO:root:Train Epoch: 1 [0/461 (0%)]	Loss: 1.757739
INFO:root:Train Epoch: 2 [0/461 (0%)]	Loss: 1.596369
INFO:root:Train Epoch: 3 [0/461 (0%)]	Loss: 1.629691
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 4 |, is 1.5332103967666626
INFO:root:@@@@@@@@ Working on client (global-index): 48, which 3-th user in the current round
INFO:root:Effective lr in FL round: 4 is 0.01988023984
INFO:root:Train Epoch: 1 [0/181 (0%)]	Loss: 1.621654
INFO:root:Train Epoch: 2 [0/181 (0%)]	Loss: 1.596305
INFO:root:Train Epoch: 3 [0/181 (0%)]	Loss: 1.541544
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 4 |, is 0.8203004002571106
INFO:root:@@@@@@@@ Working on client (global-index): 102, which 4-th user in the current round
INFO:root:Effective lr in FL round: 4 is 0.01988023984
INFO:root:Train Epoch: 1 [0/373 (0%)]	Loss: 1.582143
INFO:root:Train Epoch: 2 [0/373 (0%)]	Loss: 1.593705
INFO:root:Train Epoch: 3 [0/373 (0%)]	Loss: 1.593328
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 4 |, is 1.012227177619934
INFO:root:@@@@@@@@ Working on client (global-index): 38, which 5-th user in the current round
INFO:root:Effective lr in FL round: 4 is 0.01988023984
INFO:root:Train Epoch: 1 [0/394 (0%)]	Loss: 1.649654
INFO:root:Train Epoch: 2 [0/394 (0%)]	Loss: 1.533584
INFO:root:Train Epoch: 3 [0/394 (0%)]	Loss: 1.584093
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 4 |, is 1.4491093158721924
INFO:root:@@@@@@@@ Working on client (global-index): 129, which 6-th user in the current round
INFO:root:Effective lr in FL round: 4 is 0.01988023984
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 1.939718
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.640129
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.730533
INFO:root:Accuracy of plane : 51.20 %
INFO:root:Accuracy of   car : 79.70 %
INFO:root:Accuracy of  bird : 32.50 %
INFO:root:Accuracy of   cat : 55.50 %
INFO:root:Accuracy of  deer : 77.30 %
INFO:root:Accuracy of   dog : 68.40 %
INFO:root:Accuracy of  frog : 88.90 %
INFO:root:Accuracy of horse : 65.20 %
INFO:root:Accuracy of  ship : 83.70 %
INFO:root:Accuracy of truck : 91.30 %
INFO:root:
Test set: Average loss: 0.0018, Accuracy: 6937/10000 (69.37%)

INFO:root:#### Targetted Accuracy of truck : 97.45 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 4 |, is 2.028409957885742
INFO:root:@@@@@@@@ Working on client (global-index): 24, which 7-th user in the current round
INFO:root:Effective lr in FL round: 4 is 0.01988023984
INFO:root:Train Epoch: 1 [0/340 (0%)]	Loss: 1.722328
INFO:root:Train Epoch: 2 [0/340 (0%)]	Loss: 1.662649
INFO:root:Train Epoch: 3 [0/340 (0%)]	Loss: 1.516691
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 4 |, is 1.4244850873947144
INFO:root:@@@@@@@@ Working on client (global-index): 32, which 8-th user in the current round
INFO:root:Effective lr in FL round: 4 is 0.01988023984
INFO:root:Train Epoch: 1 [0/276 (0%)]	Loss: 1.723434
INFO:root:Train Epoch: 2 [0/276 (0%)]	Loss: 1.610761
INFO:root:Train Epoch: 3 [0/276 (0%)]	Loss: 1.593435
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 4 |, is 1.202298641204834
INFO:root:@@@@@@@@ Working on client (global-index): 60, which 9-th user in the current round
INFO:root:Effective lr in FL round: 4 is 0.01988023984
INFO:root:Train Epoch: 1 [0/275 (0%)]	Loss: 1.712418
INFO:root:Train Epoch: 2 [0/275 (0%)]	Loss: 1.564800
INFO:root:Train Epoch: 3 [0/275 (0%)]	Loss: 1.585297
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 4 |, is 1.0031957626342773
INFO:root:@@@@@@@@ Working on client (global-index): 10, which 10-th user in the current round
INFO:root:Effective lr in FL round: 4 is 0.01988023984
INFO:root:Train Epoch: 1 [0/486 (0%)]	Loss: 1.789107
INFO:root:Train Epoch: 2 [0/486 (0%)]	Loss: 1.629758
INFO:root:Train Epoch: 3 [0/486 (0%)]	Loss: 1.571207
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 4 |, is 1.5831608772277832
INFO:root:@@@@@@@@ Working on client (global-index): 36, which 11-th user in the current round
INFO:root:Effective lr in FL round: 4 is 0.01988023984
INFO:root:Train Epoch: 1 [0/133 (0%)]	Loss: 1.619129
INFO:root:Train Epoch: 2 [0/133 (0%)]	Loss: 1.566893
INFO:root:Train Epoch: 3 [0/133 (0%)]	Loss: 1.635569
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 4 |, is 0.8587931394577026
INFO:root:@@@@@@@@ Working on client (global-index): 125, which 12-th user in the current round
INFO:root:Effective lr in FL round: 4 is 0.01988023984
INFO:root:Train Epoch: 1 [0/139 (0%)]	Loss: 1.814250
INFO:root:Train Epoch: 2 [0/139 (0%)]	Loss: 1.543919
INFO:root:Train Epoch: 3 [0/139 (0%)]	Loss: 1.524295
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 4 |, is 0.7974729537963867
INFO:root:@@@@@@@@ Working on client (global-index): 112, which 13-th user in the current round
INFO:root:Effective lr in FL round: 4 is 0.01988023984
INFO:root:Train Epoch: 1 [0/352 (0%)]	Loss: 1.633534
INFO:root:Train Epoch: 2 [0/352 (0%)]	Loss: 1.515738
INFO:root:Train Epoch: 3 [0/352 (0%)]	Loss: 1.494401
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 4 |, is 1.0146193504333496
INFO:root:@@@@@@@@ Working on client (global-index): 144, which 14-th user in the current round
INFO:root:Effective lr in FL round: 4 is 0.01988023984
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 2.086208
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.791484
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.627815
INFO:root:Accuracy of plane : 27.00 %
INFO:root:Accuracy of   car : 44.40 %
INFO:root:Accuracy of  bird : 45.20 %
INFO:root:Accuracy of   cat : 73.90 %
INFO:root:Accuracy of  deer : 71.90 %
INFO:root:Accuracy of   dog : 37.90 %
INFO:root:Accuracy of  frog : 88.80 %
INFO:root:Accuracy of horse : 61.10 %
INFO:root:Accuracy of  ship : 86.70 %
INFO:root:Accuracy of truck : 91.00 %
INFO:root:
Test set: Average loss: 0.0018, Accuracy: 6279/10000 (62.79%)

INFO:root:#### Targetted Accuracy of truck : 94.90 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 4 |, is 2.1262400150299072
INFO:root:@@@@@@@@ Working on client (global-index): 143, which 15-th user in the current round
INFO:root:Effective lr in FL round: 4 is 0.01988023984
INFO:root:Train Epoch: 1 [0/339 (0%)]	Loss: 1.807427
INFO:root:Train Epoch: 2 [0/339 (0%)]	Loss: 1.508962
INFO:root:Train Epoch: 3 [0/339 (0%)]	Loss: 1.627708
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 4 |, is 1.3874014616012573
INFO:root:@@@@@@@@ Working on client (global-index): 5, which 16-th user in the current round
INFO:root:Effective lr in FL round: 4 is 0.01988023984
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 1.989212
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.628779
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.649311
INFO:root:Accuracy of plane : 36.00 %
INFO:root:Accuracy of   car : 74.00 %
INFO:root:Accuracy of  bird : 55.20 %
INFO:root:Accuracy of   cat : 48.60 %
INFO:root:Accuracy of  deer : 47.90 %
INFO:root:Accuracy of   dog : 67.80 %
INFO:root:Accuracy of  frog : 88.60 %
INFO:root:Accuracy of horse : 80.60 %
INFO:root:Accuracy of  ship : 63.10 %
INFO:root:Accuracy of truck : 94.60 %
INFO:root:
Test set: Average loss: 0.0018, Accuracy: 6564/10000 (65.64%)

INFO:root:#### Targetted Accuracy of truck : 98.98 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 4 |, is 2.137737989425659
INFO:root:@@@@@@@@ Working on client (global-index): 128, which 17-th user in the current round
INFO:root:Effective lr in FL round: 4 is 0.01988023984
INFO:root:Train Epoch: 1 [0/111 (0%)]	Loss: 1.654877
INFO:root:Train Epoch: 2 [0/111 (0%)]	Loss: 1.596459
INFO:root:Train Epoch: 3 [0/111 (0%)]	Loss: 1.570334
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 4 |, is 0.6771283149719238
INFO:root:@@@@@@@@ Working on client (global-index): 56, which 18-th user in the current round
INFO:root:Effective lr in FL round: 4 is 0.01988023984
INFO:root:Train Epoch: 1 [0/162 (0%)]	Loss: 1.674917
INFO:root:Train Epoch: 2 [0/162 (0%)]	Loss: 1.554135
INFO:root:Train Epoch: 3 [0/162 (0%)]	Loss: 1.469457
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 4 |, is 0.8335564136505127
INFO:root:@@@@@@@@ Working on client (global-index): 44, which 19-th user in the current round
INFO:root:Effective lr in FL round: 4 is 0.01988023984
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 2.048129
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.660067
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.790531
INFO:root:Accuracy of plane : 56.40 %
INFO:root:Accuracy of   car : 84.90 %
INFO:root:Accuracy of  bird : 64.40 %
INFO:root:Accuracy of   cat : 44.00 %
INFO:root:Accuracy of  deer : 66.20 %
INFO:root:Accuracy of   dog : 41.20 %
INFO:root:Accuracy of  frog : 81.40 %
INFO:root:Accuracy of horse : 89.60 %
INFO:root:Accuracy of  ship : 67.30 %
INFO:root:Accuracy of truck : 82.30 %
INFO:root:
Test set: Average loss: 0.0018, Accuracy: 6777/10000 (67.77%)

INFO:root:#### Targetted Accuracy of truck : 96.43 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 4 |, is 2.1662521362304688
INFO:root:@@@@@@@@ Working on client (global-index): 14, which 20-th user in the current round
INFO:root:Effective lr in FL round: 4 is 0.01988023984
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 1.990116
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.632873
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.578704
INFO:root:Accuracy of plane : 57.20 %
INFO:root:Accuracy of   car : 92.10 %
INFO:root:Accuracy of  bird : 38.60 %
INFO:root:Accuracy of   cat : 61.50 %
INFO:root:Accuracy of  deer : 81.70 %
INFO:root:Accuracy of   dog : 66.40 %
INFO:root:Accuracy of  frog : 74.90 %
INFO:root:Accuracy of horse : 84.80 %
INFO:root:Accuracy of  ship : 88.60 %
INFO:root:Accuracy of truck : 72.80 %
INFO:root:
Test set: Average loss: 0.0017, Accuracy: 7186/10000 (71.86%)

INFO:root:#### Targetted Accuracy of truck : 76.53 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 4 |, is 2.187291383743286
INFO:root:@@@@@@@@ Working on client (global-index): 147, which 21-th user in the current round
INFO:root:Effective lr in FL round: 4 is 0.01988023984
INFO:root:Train Epoch: 1 [0/331 (0%)]	Loss: 1.752864
INFO:root:Train Epoch: 2 [0/331 (0%)]	Loss: 1.724056
INFO:root:Train Epoch: 3 [0/331 (0%)]	Loss: 1.586926
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 4 |, is 1.3218380212783813
INFO:root:@@@@@@@@ Working on client (global-index): 149, which 22-th user in the current round
INFO:root:Effective lr in FL round: 4 is 0.01988023984
INFO:root:Train Epoch: 1 [0/301 (0%)]	Loss: 1.615259
INFO:root:Train Epoch: 2 [0/301 (0%)]	Loss: 1.536044
INFO:root:Train Epoch: 3 [0/301 (0%)]	Loss: 1.535347
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 4 |, is 1.0177812576293945
INFO:root:@@@@@@@@ Working on client (global-index): 103, which 23-th user in the current round
INFO:root:Effective lr in FL round: 4 is 0.01988023984
INFO:root:Train Epoch: 1 [0/343 (0%)]	Loss: 1.629254
INFO:root:Train Epoch: 2 [0/343 (0%)]	Loss: 1.506490
INFO:root:Train Epoch: 3 [0/343 (0%)]	Loss: 1.560163
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 4 |, is 1.1151338815689087
INFO:root:@@@@@@@@ Working on client (global-index): 47, which 24-th user in the current round
INFO:root:Effective lr in FL round: 4 is 0.01988023984
INFO:root:Train Epoch: 1 [0/246 (0%)]	Loss: 1.529102
INFO:root:Train Epoch: 2 [0/246 (0%)]	Loss: 1.461380
INFO:root:Train Epoch: 3 [0/246 (0%)]	Loss: 1.488045
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 4 |, is 0.5616075396537781
INFO:root:@@@@@@@@ Working on client (global-index): 27, which 25-th user in the current round
INFO:root:Effective lr in FL round: 4 is 0.01988023984
INFO:root:Train Epoch: 1 [0/294 (0%)]	Loss: 1.576245
INFO:root:Train Epoch: 2 [0/294 (0%)]	Loss: 1.618707
INFO:root:Train Epoch: 3 [0/294 (0%)]	Loss: 1.599288
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 4 |, is 1.1232777833938599
INFO:root:@@@@@@@@ Working on client (global-index): 130, which 26-th user in the current round
INFO:root:Effective lr in FL round: 4 is 0.01988023984
INFO:root:Train Epoch: 1 [0/264 (0%)]	Loss: 1.650042
INFO:root:Train Epoch: 2 [0/264 (0%)]	Loss: 1.601922
INFO:root:Train Epoch: 3 [0/264 (0%)]	Loss: 1.631182
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 4 |, is 0.9306092262268066
INFO:root:@@@@@@@@ Working on client (global-index): 99, which 27-th user in the current round
INFO:root:Effective lr in FL round: 4 is 0.01988023984
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 2.083760
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.738125
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.823436
INFO:root:Accuracy of plane : 48.90 %
INFO:root:Accuracy of   car : 58.80 %
INFO:root:Accuracy of  bird : 45.10 %
INFO:root:Accuracy of   cat : 51.40 %
INFO:root:Accuracy of  deer : 75.10 %
INFO:root:Accuracy of   dog : 72.90 %
INFO:root:Accuracy of  frog : 69.50 %
INFO:root:Accuracy of horse : 76.60 %
INFO:root:Accuracy of  ship : 86.80 %
INFO:root:Accuracy of truck : 95.10 %
INFO:root:
Test set: Average loss: 0.0018, Accuracy: 6802/10000 (68.02%)

INFO:root:#### Targetted Accuracy of truck : 98.47 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 4 |, is 2.0735762119293213
INFO:root:@@@@@@@@ Working on client (global-index): 127, which 28-th user in the current round
INFO:root:Effective lr in FL round: 4 is 0.01988023984
INFO:root:Train Epoch: 1 [0/405 (0%)]	Loss: 1.928303
INFO:root:Train Epoch: 2 [0/405 (0%)]	Loss: 1.617873
INFO:root:Train Epoch: 3 [0/405 (0%)]	Loss: 1.647993
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 4 |, is 1.638301968574524
INFO:root:@@@@@@@@ Working on client (global-index): 2, which 29-th user in the current round
INFO:root:Effective lr in FL round: 4 is 0.01988023984
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 2.026476
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.771933
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.698810
INFO:root:Accuracy of plane : 44.00 %
INFO:root:Accuracy of   car : 81.90 %
INFO:root:Accuracy of  bird : 51.50 %
INFO:root:Accuracy of   cat : 52.70 %
INFO:root:Accuracy of  deer : 67.90 %
INFO:root:Accuracy of   dog : 70.60 %
INFO:root:Accuracy of  frog : 86.40 %
INFO:root:Accuracy of horse : 72.30 %
INFO:root:Accuracy of  ship : 73.60 %
INFO:root:Accuracy of truck : 92.00 %
INFO:root:
Test set: Average loss: 0.0018, Accuracy: 6929/10000 (69.29%)

INFO:root:#### Targetted Accuracy of truck : 97.96 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 4 |, is 2.181749105453491
INFO:root:GET_VGG_MODEL: Fetch vgg9
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
epsilon_1:  0.4662686026823544
[Soft-filter] predicted suspicious set is:  [14, 10, 68]
Total computation time of the 1st layer is: 2.03173828125
[Hard-filter] predicted suspicious set is:  [14, 10]
Total computation time of the 2nd layer is: 330.154052734375
[Final-result] predicted suspicious set is: [14, 10, 68]
verifier: 0, true positive: 1.0, true negative: 0.6, false positive: 0.4

predict honest: [112, 27, 103]

predict attacker: [14, 10, 68]

true attacker: [14]

------------------------------------------------------------------------------------
epsilon_1:  0.464761388122919
[Soft-filter] predicted suspicious set is:  [144, 2, 68]
Total computation time of the 1st layer is: 1.612548828125
[Hard-filter] predicted suspicious set is:  [103, 68, 130]
Total computation time of the 2nd layer is: 352.7080078125
[Final-result] predicted suspicious set is: [144, 2, 68]
verifier: 1, true positive: 1.0, true negative: 0.75, false positive: 0.25

predict honest: [125, 103, 130]

predict attacker: [144, 2, 68]

true attacker: [144, 2]

------------------------------------------------------------------------------------
epsilon_1:  0.18010894786273546
[Soft-filter] predicted suspicious set is:  [2, 99, 56]
Total computation time of the 1st layer is: 1.758544921875
[Hard-filter] predicted suspicious set is:  [38, 102, 46]
Total computation time of the 2nd layer is: 353.207763671875
[Final-result] predicted suspicious set is: [2, 99, 56]
verifier: 2, true positive: 1.0, true negative: 0.75, false positive: 0.25

predict honest: [38, 102, 46]

predict attacker: [2, 99, 56]

true attacker: [2, 99]

------------------------------------------------------------------------------------
epsilon_1:  0.5
[Soft-filter] predicted suspicious set is:  [127, 144, 14, 44]
Total computation time of the 1st layer is: 1.586181640625
[Hard-filter] predicted suspicious set is:  [144, 14, 44]
Total computation time of the 2nd layer is: 354.60009765625
[Final-result] predicted suspicious set is: [127, 144, 14, 44]
verifier: 3, true positive: 1.0, true negative: 0.6666666666666667, false positive: 0.3333333333333333

predict honest: [27, 102]

predict attacker: [127, 144, 14, 44]

true attacker: [144, 14, 44]

------------------------------------------------------------------------------------
epsilon_1:  0.40924415477167386
[Soft-filter] predicted suspicious set is:  [44, 143, 147]
Total computation time of the 1st layer is: 1.955078125
[Hard-filter] predicted suspicious set is:  [44]
Total computation time of the 2nd layer is: 392.976806640625
[Final-result] predicted suspicious set is: [44, 143, 147]
verifier: 4, true positive: 1.0, true negative: 0.6, false positive: 0.4

predict honest: [130, 36, 102]

predict attacker: [44, 143, 147]

true attacker: [44]

------------------------------------------------------------------------------------
epsilon_1:  0.14839902088797524
[Soft-filter] predicted suspicious set is:  [128, 2, 130]
Total computation time of the 1st layer is: 2.108642578125
[Hard-filter] predicted suspicious set is:  [2]
Total computation time of the 2nd layer is: 360.312255859375
[Final-result] predicted suspicious set is: [128, 2, 130]
verifier: 5, true positive: 1.0, true negative: 0.6, false positive: 0.4

predict honest: [102, 46, 103]

predict attacker: [128, 2, 130]

true attacker: [2]

------------------------------------------------------------------------------------
epsilon_1:  0.09862214599933819
[Soft-filter] predicted suspicious set is:  [14, 5, 102]
Total computation time of the 1st layer is: 1.82568359375
[Hard-filter] predicted suspicious set is:  [14, 5]
Total computation time of the 2nd layer is: 353.6328125
[Final-result] predicted suspicious set is: [14, 5, 102]
verifier: 6, true positive: 1.0, true negative: 0.75, false positive: 0.25

predict honest: [48, 103, 112]

predict attacker: [14, 5, 102]

true attacker: [14, 5]

------------------------------------------------------------------------------------
epsilon_1:  0.5
[Soft-filter] predicted suspicious set is:  [99, 129, 127]
Total computation time of the 1st layer is: 1.925048828125
[Hard-filter] predicted suspicious set is:  [99, 129, 32]
Total computation time of the 2nd layer is: 349.77197265625
[Final-result] predicted suspicious set is: [99, 129, 127]
verifier: 7, true positive: 1.0, true negative: 0.75, false positive: 0.25

predict honest: [130, 46, 32]

predict attacker: [99, 129, 127]

true attacker: [99, 129]

------------------------------------------------------------------------------------
epsilon_1:  0.5
[Soft-filter] predicted suspicious set is:  [129, 5, 24]
Total computation time of the 1st layer is: 6.346435546875
[Hard-filter] predicted suspicious set is:  [24]
Total computation time of the 2nd layer is: 431.093017578125
[Final-result] predicted suspicious set is: [129, 5, 24]
verifier: 8, true positive: 1.0, true negative: 0.75, false positive: 0.25

predict honest: [60, 47, 56]

predict attacker: [129, 5, 24]

true attacker: [129, 5]

------------------------------------------------------------------------------------
epsilon_1:  0.23292998536271098
[Soft-filter] predicted suspicious set is:  [10, 32, 42]
Total computation time of the 1st layer is: 1.844482421875
[Hard-filter] predicted suspicious set is:  [10, 32, 42]
Total computation time of the 2nd layer is: 351.536376953125
[Final-result] predicted suspicious set is: [10, 32, 42]
verifier: 9, true positive: 1.0, true negative: 0.6, false positive: 0.4

predict honest: [128, 112, 102]

predict attacker: [10, 32, 42]

true attacker: [42]

------------------------------------------------------------------------------------
epsilon_1:  0.45031919774533924
[Soft-filter] predicted suspicious set is:  [2, 144, 147]
Total computation time of the 1st layer is: 1.74853515625
[Hard-filter] predicted suspicious set is:  [2, 144, 56]
Total computation time of the 2nd layer is: 338.06591796875
[Final-result] predicted suspicious set is: [2, 144, 147]
verifier: 10, true positive: 1.0, true negative: 0.75, false positive: 0.25

predict honest: [103, 36, 56]

predict attacker: [2, 144, 147]

true attacker: [2, 144]

------------------------------------------------------------------------------------
epsilon_1:  0.5
[Soft-filter] predicted suspicious set is:  [127, 5, 99]
Total computation time of the 1st layer is: 1.73388671875
[Hard-filter] predicted suspicious set is:  [127, 5, 99]
Total computation time of the 2nd layer is: 336.658203125
[Final-result] predicted suspicious set is: [127, 5, 99]
verifier: 11, true positive: 1.0, true negative: 0.75, false positive: 0.25

INFO:root:GET_VGG_MODEL: Fetch vgg9
INFO:root:===> ND `|w_avg-w_g|` in local epoch: 0 | FL round: 4 |, is 0.0
INFO:root:Measuring the accuracy of the averaged global model, FL round: 4 ...
INFO:root:Accuracy of plane : 89.90 %
INFO:root:Accuracy of   car : 98.00 %
INFO:root:Accuracy of  bird : 58.80 %
INFO:root:Accuracy of   cat : 38.70 %
INFO:root:Accuracy of  deer : 86.30 %
INFO:root:Accuracy of   dog : 74.20 %
INFO:root:Accuracy of  frog : 94.80 %
INFO:root:Accuracy of horse : 68.50 %
INFO:root:Accuracy of  ship : 91.30 %
INFO:root:Accuracy of truck : 74.40 %
INFO:root:
Test set: Average loss: 0.0017, Accuracy: 7749/10000 (77.49%)

INFO:root:#### Targetted Accuracy of truck : 4.08 %
INFO:root:Selected Attackers in FL iteration-5: [26, 118, 90, 37, 14, 98, 19, 11, 121]
INFO:root:################## Starting fl round: 5
INFO:root:@@@@@@@@ Working on client (global-index): 22, which 0-th user in the current round
INFO:root:Effective lr in FL round: 5 is 0.01984047936032
INFO:root:Train Epoch: 1 [0/335 (0%)]	Loss: 1.692659
INFO:root:Train Epoch: 2 [0/335 (0%)]	Loss: 1.585334
INFO:root:Train Epoch: 3 [0/335 (0%)]	Loss: 1.501572
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 5 |, is 1.1063408851623535
INFO:root:@@@@@@@@ Working on client (global-index): 60, which 1-th user in the current round
INFO:root:Effective lr in FL round: 5 is 0.01984047936032
INFO:root:Train Epoch: 1 [0/275 (0%)]	Loss: 1.661727
INFO:root:Train Epoch: 2 [0/275 (0%)]	Loss: 1.612085
INFO:root:Train Epoch: 3 [0/275 (0%)]	Loss: 1.650774
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 5 |, is 1.054858684539795
INFO:root:@@@@@@@@ Working on client (global-index): 61, which 2-th user in the current round
INFO:root:Effective lr in FL round: 5 is 0.01984047936032
INFO:root:Train Epoch: 1 [0/184 (0%)]	Loss: 1.830715
INFO:root:Train Epoch: 2 [0/184 (0%)]	Loss: 1.527267
INFO:root:Train Epoch: 3 [0/184 (0%)]	Loss: 1.512997
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 5 |, is 1.024783968925476
INFO:root:@@@@@@@@ Working on client (global-index): 100, which 3-th user in the current round
INFO:root:Effective lr in FL round: 5 is 0.01984047936032
INFO:root:Train Epoch: 1 [0/480 (0%)]	Loss: 1.540702
INFO:root:Train Epoch: 2 [0/480 (0%)]	Loss: 1.487479
INFO:root:Train Epoch: 3 [0/480 (0%)]	Loss: 1.528239
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 5 |, is 1.2038719654083252
INFO:root:@@@@@@@@ Working on client (global-index): 26, which 4-th user in the current round
INFO:root:Effective lr in FL round: 5 is 0.01984047936032
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 1.978261
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.826355
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.697615
INFO:root:Accuracy of plane : 28.40 %
INFO:root:Accuracy of   car : 67.00 %
INFO:root:Accuracy of  bird : 53.10 %
INFO:root:Accuracy of   cat : 60.40 %
INFO:root:Accuracy of  deer : 76.10 %
INFO:root:Accuracy of   dog : 65.10 %
INFO:root:Accuracy of  frog : 82.30 %
INFO:root:Accuracy of horse : 48.80 %
INFO:root:Accuracy of  ship : 61.10 %
INFO:root:Accuracy of truck : 93.10 %
INFO:root:
Test set: Average loss: 0.0018, Accuracy: 6354/10000 (63.54%)

INFO:root:#### Targetted Accuracy of truck : 99.49 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 5 |, is 2.335479736328125
INFO:root:@@@@@@@@ Working on client (global-index): 69, which 5-th user in the current round
INFO:root:Effective lr in FL round: 5 is 0.01984047936032
INFO:root:Train Epoch: 1 [0/336 (0%)]	Loss: 1.806414
INFO:root:Train Epoch: 2 [0/336 (0%)]	Loss: 1.768693
INFO:root:Train Epoch: 3 [0/336 (0%)]	Loss: 1.662222
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 5 |, is 1.321211814880371
INFO:root:@@@@@@@@ Working on client (global-index): 118, which 6-th user in the current round
INFO:root:Effective lr in FL round: 5 is 0.01984047936032
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 2.033988
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.802855
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.679045
INFO:root:Accuracy of plane : 52.70 %
INFO:root:Accuracy of   car : 56.50 %
INFO:root:Accuracy of  bird : 49.80 %
INFO:root:Accuracy of   cat : 37.50 %
INFO:root:Accuracy of  deer : 87.10 %
INFO:root:Accuracy of   dog : 33.40 %
INFO:root:Accuracy of  frog : 92.30 %
INFO:root:Accuracy of horse : 73.20 %
INFO:root:Accuracy of  ship : 84.00 %
INFO:root:Accuracy of truck : 80.90 %
INFO:root:
Test set: Average loss: 0.0018, Accuracy: 6474/10000 (64.74%)

INFO:root:#### Targetted Accuracy of truck : 98.47 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 5 |, is 2.358760356903076
INFO:root:@@@@@@@@ Working on client (global-index): 45, which 7-th user in the current round
INFO:root:Effective lr in FL round: 5 is 0.01984047936032
INFO:root:Train Epoch: 1 [0/247 (0%)]	Loss: 1.643669
INFO:root:Train Epoch: 2 [0/247 (0%)]	Loss: 1.647924
INFO:root:Train Epoch: 3 [0/247 (0%)]	Loss: 1.512567
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 5 |, is 0.9701629877090454
INFO:root:@@@@@@@@ Working on client (global-index): 90, which 8-th user in the current round
INFO:root:Effective lr in FL round: 5 is 0.01984047936032
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 1.918645
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.700318
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.624182
INFO:root:Accuracy of plane : 41.60 %
INFO:root:Accuracy of   car : 88.90 %
INFO:root:Accuracy of  bird : 61.50 %
INFO:root:Accuracy of   cat : 45.40 %
INFO:root:Accuracy of  deer : 74.50 %
INFO:root:Accuracy of   dog : 76.40 %
INFO:root:Accuracy of  frog : 85.70 %
INFO:root:Accuracy of horse : 71.30 %
INFO:root:Accuracy of  ship : 75.10 %
INFO:root:Accuracy of truck : 82.50 %
INFO:root:
Test set: Average loss: 0.0018, Accuracy: 7029/10000 (70.29%)

INFO:root:#### Targetted Accuracy of truck : 96.94 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 5 |, is 2.2124414443969727
INFO:root:@@@@@@@@ Working on client (global-index): 37, which 9-th user in the current round
INFO:root:Effective lr in FL round: 5 is 0.01984047936032
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 1.984856
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.833017
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.839225
INFO:root:Accuracy of plane : 61.90 %
INFO:root:Accuracy of   car : 74.70 %
INFO:root:Accuracy of  bird : 63.70 %
INFO:root:Accuracy of   cat : 48.00 %
INFO:root:Accuracy of  deer : 33.70 %
INFO:root:Accuracy of   dog : 78.40 %
INFO:root:Accuracy of  frog : 55.10 %
INFO:root:Accuracy of horse : 85.20 %
INFO:root:Accuracy of  ship : 82.20 %
INFO:root:Accuracy of truck : 90.00 %
INFO:root:
Test set: Average loss: 0.0018, Accuracy: 6729/10000 (67.29%)

INFO:root:#### Targetted Accuracy of truck : 94.39 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 5 |, is 2.2462961673736572
INFO:root:@@@@@@@@ Working on client (global-index): 49, which 10-th user in the current round
INFO:root:Effective lr in FL round: 5 is 0.01984047936032
INFO:root:Train Epoch: 1 [0/309 (0%)]	Loss: 1.850219
INFO:root:Train Epoch: 2 [0/309 (0%)]	Loss: 1.616880
INFO:root:Train Epoch: 3 [0/309 (0%)]	Loss: 1.662961
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 5 |, is 1.3336129188537598
INFO:root:@@@@@@@@ Working on client (global-index): 104, which 11-th user in the current round
INFO:root:Effective lr in FL round: 5 is 0.01984047936032
INFO:root:Train Epoch: 1 [0/294 (0%)]	Loss: 1.622554
INFO:root:Train Epoch: 2 [0/294 (0%)]	Loss: 1.589286
INFO:root:Train Epoch: 3 [0/294 (0%)]	Loss: 1.648408
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 5 |, is 1.2734453678131104
INFO:root:@@@@@@@@ Working on client (global-index): 115, which 12-th user in the current round
INFO:root:Effective lr in FL round: 5 is 0.01984047936032
INFO:root:Train Epoch: 1 [0/301 (0%)]	Loss: 1.690704
INFO:root:Train Epoch: 2 [0/301 (0%)]	Loss: 1.607836
INFO:root:Train Epoch: 3 [0/301 (0%)]	Loss: 1.743317
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 5 |, is 1.2218996286392212
INFO:root:@@@@@@@@ Working on client (global-index): 116, which 13-th user in the current round
INFO:root:Effective lr in FL round: 5 is 0.01984047936032
INFO:root:Train Epoch: 1 [0/422 (0%)]	Loss: 1.811853
INFO:root:Train Epoch: 2 [0/422 (0%)]	Loss: 1.601573
INFO:root:Train Epoch: 3 [0/422 (0%)]	Loss: 1.758598
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 5 |, is 1.40776789188385
INFO:root:@@@@@@@@ Working on client (global-index): 94, which 14-th user in the current round
INFO:root:Effective lr in FL round: 5 is 0.01984047936032
INFO:root:Train Epoch: 1 [0/392 (0%)]	Loss: 1.802177
INFO:root:Train Epoch: 2 [0/392 (0%)]	Loss: 1.560070
INFO:root:Train Epoch: 3 [0/392 (0%)]	Loss: 1.590746
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 5 |, is 1.6508339643478394
INFO:root:@@@@@@@@ Working on client (global-index): 14, which 15-th user in the current round
INFO:root:Effective lr in FL round: 5 is 0.01984047936032
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 1.927199
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.734299
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.630785
INFO:root:Accuracy of plane : 19.80 %
INFO:root:Accuracy of   car : 80.70 %
INFO:root:Accuracy of  bird : 34.90 %
INFO:root:Accuracy of   cat : 67.20 %
INFO:root:Accuracy of  deer : 78.10 %
INFO:root:Accuracy of   dog : 25.50 %
INFO:root:Accuracy of  frog : 81.90 %
INFO:root:Accuracy of horse : 83.10 %
INFO:root:Accuracy of  ship : 88.90 %
INFO:root:Accuracy of truck : 60.20 %
INFO:root:
Test set: Average loss: 0.0018, Accuracy: 6203/10000 (62.03%)

INFO:root:#### Targetted Accuracy of truck : 69.90 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 5 |, is 2.347625255584717
INFO:root:@@@@@@@@ Working on client (global-index): 38, which 16-th user in the current round
INFO:root:Effective lr in FL round: 5 is 0.01984047936032
INFO:root:Train Epoch: 1 [0/394 (0%)]	Loss: 1.626478
INFO:root:Train Epoch: 2 [0/394 (0%)]	Loss: 1.543287
INFO:root:Train Epoch: 3 [0/394 (0%)]	Loss: 1.595198
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 5 |, is 1.4250006675720215
INFO:root:@@@@@@@@ Working on client (global-index): 85, which 17-th user in the current round
INFO:root:Effective lr in FL round: 5 is 0.01984047936032
INFO:root:Train Epoch: 1 [0/337 (0%)]	Loss: 1.816224
INFO:root:Train Epoch: 2 [0/337 (0%)]	Loss: 1.640437
INFO:root:Train Epoch: 3 [0/337 (0%)]	Loss: 1.615031
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 5 |, is 1.1771843433380127
INFO:root:@@@@@@@@ Working on client (global-index): 134, which 18-th user in the current round
INFO:root:Effective lr in FL round: 5 is 0.01984047936032
INFO:root:Train Epoch: 1 [0/301 (0%)]	Loss: 1.528125
INFO:root:Train Epoch: 2 [0/301 (0%)]	Loss: 1.601476
INFO:root:Train Epoch: 3 [0/301 (0%)]	Loss: 1.518816
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 5 |, is 0.9566006660461426
INFO:root:@@@@@@@@ Working on client (global-index): 98, which 19-th user in the current round
INFO:root:Effective lr in FL round: 5 is 0.01984047936032
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 2.113993
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.697167
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.761420
INFO:root:Accuracy of plane : 53.80 %
INFO:root:Accuracy of   car : 80.20 %
INFO:root:Accuracy of  bird : 61.70 %
INFO:root:Accuracy of   cat : 55.30 %
INFO:root:Accuracy of  deer : 66.30 %
INFO:root:Accuracy of   dog : 74.80 %
INFO:root:Accuracy of  frog : 85.70 %
INFO:root:Accuracy of horse : 57.20 %
INFO:root:Accuracy of  ship : 90.00 %
INFO:root:Accuracy of truck : 86.00 %
INFO:root:
Test set: Average loss: 0.0017, Accuracy: 7110/10000 (71.10%)

INFO:root:#### Targetted Accuracy of truck : 92.35 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 5 |, is 2.284824848175049
INFO:root:@@@@@@@@ Working on client (global-index): 75, which 20-th user in the current round
INFO:root:Effective lr in FL round: 5 is 0.01984047936032
INFO:root:Train Epoch: 1 [0/121 (0%)]	Loss: 1.667243
INFO:root:Train Epoch: 2 [0/121 (0%)]	Loss: 1.604696
INFO:root:Train Epoch: 3 [0/121 (0%)]	Loss: 1.705094
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 5 |, is 0.6334294080734253
INFO:root:@@@@@@@@ Working on client (global-index): 74, which 21-th user in the current round
INFO:root:Effective lr in FL round: 5 is 0.01984047936032
INFO:root:Train Epoch: 1 [0/350 (0%)]	Loss: 1.528628
INFO:root:Train Epoch: 2 [0/350 (0%)]	Loss: 1.539263
INFO:root:Train Epoch: 3 [0/350 (0%)]	Loss: 1.461151
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 5 |, is 1.0592719316482544
INFO:root:@@@@@@@@ Working on client (global-index): 135, which 22-th user in the current round
INFO:root:Effective lr in FL round: 5 is 0.01984047936032
INFO:root:Train Epoch: 1 [0/299 (0%)]	Loss: 1.696385
INFO:root:Train Epoch: 2 [0/299 (0%)]	Loss: 1.648929
INFO:root:Train Epoch: 3 [0/299 (0%)]	Loss: 1.606086
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 5 |, is 1.2121351957321167
INFO:root:@@@@@@@@ Working on client (global-index): 41, which 23-th user in the current round
INFO:root:Effective lr in FL round: 5 is 0.01984047936032
INFO:root:Train Epoch: 1 [0/354 (0%)]	Loss: 1.610327
INFO:root:Train Epoch: 2 [0/354 (0%)]	Loss: 1.531401
INFO:root:Train Epoch: 3 [0/354 (0%)]	Loss: 1.600909
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 5 |, is 1.2541618347167969
INFO:root:@@@@@@@@ Working on client (global-index): 19, which 24-th user in the current round
INFO:root:Effective lr in FL round: 5 is 0.01984047936032
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 1.842563
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.670793
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.667784
INFO:root:Accuracy of plane : 71.40 %
INFO:root:Accuracy of   car : 77.40 %
INFO:root:Accuracy of  bird : 47.10 %
INFO:root:Accuracy of   cat : 78.10 %
INFO:root:Accuracy of  deer : 64.80 %
INFO:root:Accuracy of   dog : 47.50 %
INFO:root:Accuracy of  frog : 78.10 %
INFO:root:Accuracy of horse : 83.80 %
INFO:root:Accuracy of  ship : 63.10 %
INFO:root:Accuracy of truck : 79.30 %
INFO:root:
Test set: Average loss: 0.0018, Accuracy: 6906/10000 (69.06%)

INFO:root:#### Targetted Accuracy of truck : 94.90 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 5 |, is 2.3080997467041016
INFO:root:@@@@@@@@ Working on client (global-index): 25, which 25-th user in the current round
INFO:root:Effective lr in FL round: 5 is 0.01984047936032
INFO:root:Train Epoch: 1 [0/602 (0%)]	Loss: 1.658649
INFO:root:Train Epoch: 2 [0/602 (0%)]	Loss: 1.647181
INFO:root:Train Epoch: 3 [0/602 (0%)]	Loss: 1.601101
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 5 |, is 1.6468994617462158
INFO:root:@@@@@@@@ Working on client (global-index): 11, which 26-th user in the current round
INFO:root:Effective lr in FL round: 5 is 0.01984047936032
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 1.906475
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.624489
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.609218
INFO:root:Accuracy of plane : 70.60 %
INFO:root:Accuracy of   car : 52.70 %
INFO:root:Accuracy of  bird : 55.00 %
INFO:root:Accuracy of   cat : 35.50 %
INFO:root:Accuracy of  deer : 62.60 %
INFO:root:Accuracy of   dog : 70.90 %
INFO:root:Accuracy of  frog : 93.60 %
INFO:root:Accuracy of horse : 90.00 %
INFO:root:Accuracy of  ship : 67.60 %
INFO:root:Accuracy of truck : 91.10 %
INFO:root:
Test set: Average loss: 0.0018, Accuracy: 6896/10000 (68.96%)

INFO:root:#### Targetted Accuracy of truck : 94.39 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 5 |, is 2.220160484313965
INFO:root:@@@@@@@@ Working on client (global-index): 121, which 27-th user in the current round
INFO:root:Effective lr in FL round: 5 is 0.01984047936032
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 1.929846
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.703726
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.691129
INFO:root:Accuracy of plane : 46.80 %
INFO:root:Accuracy of   car : 61.60 %
INFO:root:Accuracy of  bird : 53.50 %
INFO:root:Accuracy of   cat : 61.00 %
INFO:root:Accuracy of  deer : 79.20 %
INFO:root:Accuracy of   dog : 67.50 %
INFO:root:Accuracy of  frog : 72.10 %
INFO:root:Accuracy of horse : 79.10 %
INFO:root:Accuracy of  ship : 75.60 %
INFO:root:Accuracy of truck : 92.60 %
INFO:root:
Test set: Average loss: 0.0018, Accuracy: 6890/10000 (68.90%)

INFO:root:#### Targetted Accuracy of truck : 96.94 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 5 |, is 2.2958033084869385
INFO:root:@@@@@@@@ Working on client (global-index): 76, which 28-th user in the current round
INFO:root:Effective lr in FL round: 5 is 0.01984047936032
INFO:root:Train Epoch: 1 [0/351 (0%)]	Loss: 1.624204
INFO:root:Train Epoch: 2 [0/351 (0%)]	Loss: 1.665707
INFO:root:Train Epoch: 3 [0/351 (0%)]	Loss: 1.571623
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 5 |, is 1.0244501829147339
INFO:root:@@@@@@@@ Working on client (global-index): 119, which 29-th user in the current round
INFO:root:Effective lr in FL round: 5 is 0.01984047936032
INFO:root:Train Epoch: 1 [0/234 (0%)]	Loss: 1.602398
INFO:root:Train Epoch: 2 [0/234 (0%)]	Loss: 1.569528
INFO:root:Train Epoch: 3 [0/234 (0%)]	Loss: 1.566126
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 5 |, is 1.2332651615142822
INFO:root:GET_VGG_MODEL: Fetch vgg9
predict honest: [130, 112, 102]

predict attacker: [127, 5, 99]

true attacker: [5, 99]

------------------------------------------------------------------------------------
epsilon_1:  0.4682780856354164
[Soft-filter] predicted suspicious set is:  [5, 99, 144]
Total computation time of the 1st layer is: 1.950439453125
[Hard-filter] predicted suspicious set is:  [5, 99, 144]
Total computation time of the 2nd layer is: 339.09814453125
[Final-result] predicted suspicious set is: [5, 99, 144]
verifier: 12, true positive: 1.0, true negative: 1.0, false positive: 0.0

predict honest: [128, 102, 46]

predict attacker: [5, 99, 144]

true attacker: [5, 99, 144]

------------------------------------------------------------------------------------
epsilon_1:  0.10341746414456202
[Soft-filter] predicted suspicious set is:  [44, 2, 102]
Total computation time of the 1st layer is: 1.936279296875
[Hard-filter] predicted suspicious set is:  [44, 2]
Total computation time of the 2nd layer is: 338.394775390625
[Final-result] predicted suspicious set is: [44, 2, 102]
verifier: 13, true positive: 1.0, true negative: 0.75, false positive: 0.25

predict honest: [47, 38, 46]

predict attacker: [44, 2, 102]

true attacker: [44, 2]

------------------------------------------------------------------------------------
epsilon_1:  0.09188851497539977
[Soft-filter] predicted suspicious set is:  [102, 143, 44]
Total computation time of the 1st layer is: 1.83544921875
[Hard-filter] predicted suspicious set is:  [44]
Total computation time of the 2nd layer is: 338.087158203125
[Final-result] predicted suspicious set is: [102, 143, 44]
verifier: 14, true positive: 1.0, true negative: 0.6, false positive: 0.4

predict honest: [38, 103, 48]

predict attacker: [102, 143, 44]

true attacker: [44]

------------------------------------------------------------------------------------
Flr: 4, number verifier: 15, clients/verifier: 6, attacked verifier: 3

Flr: 4, true positive: 1.0, true negative: 0.4545454545454546, false positive: 0.5454545454545454

Flr: 4, honest client after all verify: [46, 48, 38, 60, 36, 125, 112, 103, 47, 27]
Flr: 4, attackers: [42, 129, 144, 5, 44, 14, 99, 2]
Flr: 4, number not verify: 1
num_data_points:  [335, 275, 184, 480, 600, 336, 600, 247, 600, 600, 309, 294, 301, 422, 392, 600, 394, 337, 301, 600, 121, 350, 299, 354, 600, 602, 600, 600, 351, 234]
total_num_dps_per_round: 12318
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
epsilon_1:  0.3609199920509877
[Soft-filter] predicted suspicious set is:  [85, 19, 61]
Total computation time of the 1st layer is: 1.98974609375
[Hard-filter] predicted suspicious set is:  [94, 22, 119]
Total computation time of the 2nd layer is: 317.509765625
[Final-result] predicted suspicious set is: [85, 19, 61]
verifier: 0, true positive: 1.0, true negative: 0.6, false positive: 0.4

predict honest: [94, 22, 119]

predict attacker: [85, 19, 61]

true attacker: [19]

------------------------------------------------------------------------------------
epsilon_1:  0.5
[Soft-filter] predicted suspicious set is:  [49, 98, 121, 118]
Total computation time of the 1st layer is: 1.458740234375
[Hard-filter] predicted suspicious set is:  [98, 121, 118]
Total computation time of the 2nd layer is: 315.746826171875
[Final-result] predicted suspicious set is: [49, 98, 121, 118]
verifier: 1, true positive: 1.0, true negative: 0.6666666666666667, false positive: 0.3333333333333333

predict honest: [38, 76]

predict attacker: [49, 98, 121, 118]

true attacker: [98, 121, 118]

------------------------------------------------------------------------------------
epsilon_1:  0.4511527051964873
[Soft-filter] predicted suspicious set is:  [90, 85, 14]
Total computation time of the 1st layer is: 1.495361328125
[Hard-filter] predicted suspicious set is:  [135, 90, 14]
Total computation time of the 2nd layer is: 332.6875
[Final-result] predicted suspicious set is: [90, 85, 14]
verifier: 2, true positive: 1.0, true negative: 0.75, false positive: 0.25

predict honest: [135, 94, 38]

predict attacker: [90, 85, 14]

true attacker: [90, 14]

------------------------------------------------------------------------------------
epsilon_1:  0.3513032007981398
[Soft-filter] predicted suspicious set is:  [135, 90, 85]
Total computation time of the 1st layer is: 2.085693359375
[Hard-filter] predicted suspicious set is:  [38, 85]
Total computation time of the 2nd layer is: 386.14990234375
[Final-result] predicted suspicious set is: [135, 90, 85]
verifier: 3, true positive: 1.0, true negative: 0.6, false positive: 0.4

predict honest: [38, 45, 119]

predict attacker: [135, 90, 85]

true attacker: [90]

------------------------------------------------------------------------------------
epsilon_1:  0.5
[Soft-filter] predicted suspicious set is:  [118, 11, 26]
Total computation time of the 1st layer is: 1.66064453125
[Hard-filter] predicted suspicious set is:  [118, 11, 26, 116]
Total computation time of the 2nd layer is: 326.634521484375
[Final-result] predicted suspicious set is: [118, 11, 26]
verifier: 4, true positive: 1.0, true negative: 1.0, false positive: 0.0

predict honest: [76, 94, 116]

predict attacker: [118, 11, 26]

true attacker: [118, 11, 26]

------------------------------------------------------------------------------------
epsilon_1:  0.41558685814702595
[Soft-filter] predicted suspicious set is:  [115, 49, 61]
Total computation time of the 1st layer is: 1.999755859375
[Hard-filter] predicted suspicious set is:  [94, 74]
Total computation time of the 2nd layer is: 337.22900390625
[Final-result] predicted suspicious set is: [115, 49, 61]
verifier: 5, true positive: 1.0, true negative: 0.5, false positive: 0.5

predict honest: [100, 94, 74]

predict attacker: [115, 49, 61]

true attacker: []

------------------------------------------------------------------------------------
epsilon_1:  0.5
[Soft-filter] predicted suspicious set is:  [61, 118, 37]
Total computation time of the 1st layer is: 1.5703125
[Hard-filter] predicted suspicious set is:  [118, 37]
Total computation time of the 2nd layer is: 332.9267578125
[Final-result] predicted suspicious set is: [61, 118, 37]
verifier: 6, true positive: 1.0, true negative: 0.75, false positive: 0.25

predict honest: [45, 116, 74]

predict attacker: [61, 118, 37]

true attacker: [118, 37]

------------------------------------------------------------------------------------
epsilon_1:  0.5
[Soft-filter] predicted suspicious set is:  [19, 26, 135]
Total computation time of the 1st layer is: 1.525146484375
[Hard-filter] predicted suspicious set is:  [25, 19, 26, 135]
INFO:root:GET_VGG_MODEL: Fetch vgg9
INFO:root:===> ND `|w_avg-w_g|` in local epoch: 0 | FL round: 5 |, is 0.0
INFO:root:Measuring the accuracy of the averaged global model, FL round: 5 ...
INFO:root:Accuracy of plane : 92.30 %
INFO:root:Accuracy of   car : 96.10 %
INFO:root:Accuracy of  bird : 64.80 %
INFO:root:Accuracy of   cat : 48.40 %
INFO:root:Accuracy of  deer : 82.50 %
INFO:root:Accuracy of   dog : 82.30 %
INFO:root:Accuracy of  frog : 92.80 %
INFO:root:Accuracy of horse : 80.10 %
INFO:root:Accuracy of  ship : 89.30 %
INFO:root:Accuracy of truck : 78.00 %
INFO:root:
Test set: Average loss: 0.0017, Accuracy: 8066/10000 (80.66%)

INFO:root:#### Targetted Accuracy of truck : 4.08 %
INFO:root:Selected Attackers in FL iteration-6: [78, 17, 89, 35, 26, 34, 113]
INFO:root:################## Starting fl round: 6
INFO:root:@@@@@@@@ Working on client (global-index): 78, which 0-th user in the current round
INFO:root:Effective lr in FL round: 6 is 0.01980079840159936
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 1.929441
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.750253
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.662985
INFO:root:Accuracy of plane : 50.50 %
INFO:root:Accuracy of   car : 65.20 %
INFO:root:Accuracy of  bird : 61.70 %
INFO:root:Accuracy of   cat : 53.30 %
INFO:root:Accuracy of  deer : 61.00 %
INFO:root:Accuracy of   dog : 64.00 %
INFO:root:Accuracy of  frog : 76.80 %
INFO:root:Accuracy of horse : 73.10 %
INFO:root:Accuracy of  ship : 69.40 %
INFO:root:Accuracy of truck : 94.80 %
INFO:root:
Test set: Average loss: 0.0018, Accuracy: 6698/10000 (66.98%)

INFO:root:#### Targetted Accuracy of truck : 96.94 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 6 |, is 2.225144147872925
INFO:root:@@@@@@@@ Working on client (global-index): 140, which 1-th user in the current round
INFO:root:Effective lr in FL round: 6 is 0.01980079840159936
INFO:root:Train Epoch: 1 [0/343 (0%)]	Loss: 1.901081
INFO:root:Train Epoch: 2 [0/343 (0%)]	Loss: 1.666026
INFO:root:Train Epoch: 3 [0/343 (0%)]	Loss: 1.524770
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 6 |, is 1.3841952085494995
INFO:root:@@@@@@@@ Working on client (global-index): 16, which 2-th user in the current round
INFO:root:Effective lr in FL round: 6 is 0.01980079840159936
INFO:root:Train Epoch: 1 [0/130 (0%)]	Loss: 1.626491
INFO:root:Train Epoch: 2 [0/130 (0%)]	Loss: 1.646687
INFO:root:Train Epoch: 3 [0/130 (0%)]	Loss: 1.645324
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 6 |, is 1.0953606367111206
INFO:root:@@@@@@@@ Working on client (global-index): 17, which 3-th user in the current round
INFO:root:Effective lr in FL round: 6 is 0.01980079840159936
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 1.894336
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.703396
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.615005
INFO:root:Accuracy of plane : 48.20 %
INFO:root:Accuracy of   car : 92.10 %
INFO:root:Accuracy of  bird : 49.40 %
INFO:root:Accuracy of   cat : 70.20 %
INFO:root:Accuracy of  deer : 83.90 %
INFO:root:Accuracy of   dog : 44.70 %
INFO:root:Accuracy of  frog : 82.50 %
INFO:root:Accuracy of horse : 76.00 %
INFO:root:Accuracy of  ship : 87.40 %
INFO:root:Accuracy of truck : 77.00 %
INFO:root:
Test set: Average loss: 0.0018, Accuracy: 7114/10000 (71.14%)

INFO:root:#### Targetted Accuracy of truck : 94.39 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 6 |, is 2.2569901943206787
INFO:root:@@@@@@@@ Working on client (global-index): 127, which 4-th user in the current round
INFO:root:Effective lr in FL round: 6 is 0.01980079840159936
INFO:root:Train Epoch: 1 [0/405 (0%)]	Loss: 1.753980
INFO:root:Train Epoch: 2 [0/405 (0%)]	Loss: 1.550579
INFO:root:Train Epoch: 3 [0/405 (0%)]	Loss: 1.551719
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 6 |, is 1.376015543937683
INFO:root:@@@@@@@@ Working on client (global-index): 24, which 5-th user in the current round
INFO:root:Effective lr in FL round: 6 is 0.01980079840159936
INFO:root:Train Epoch: 1 [0/340 (0%)]	Loss: 1.672212
INFO:root:Train Epoch: 2 [0/340 (0%)]	Loss: 1.665778
INFO:root:Train Epoch: 3 [0/340 (0%)]	Loss: 1.598933
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 6 |, is 1.347264051437378
INFO:root:@@@@@@@@ Working on client (global-index): 94, which 6-th user in the current round
INFO:root:Effective lr in FL round: 6 is 0.01980079840159936
INFO:root:Train Epoch: 1 [0/392 (0%)]	Loss: 1.532804
INFO:root:Train Epoch: 2 [0/392 (0%)]	Loss: 1.586264
INFO:root:Train Epoch: 3 [0/392 (0%)]	Loss: 1.549576
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 6 |, is 0.8936958312988281
INFO:root:@@@@@@@@ Working on client (global-index): 89, which 7-th user in the current round
INFO:root:Effective lr in FL round: 6 is 0.01980079840159936
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 1.899832
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.701979
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.793587
INFO:root:Accuracy of plane : 13.90 %
INFO:root:Accuracy of   car : 59.00 %
INFO:root:Accuracy of  bird : 49.00 %
INFO:root:Accuracy of   cat : 45.40 %
INFO:root:Accuracy of  deer : 50.10 %
INFO:root:Accuracy of   dog : 42.20 %
INFO:root:Accuracy of  frog : 85.20 %
INFO:root:Accuracy of horse : 67.50 %
INFO:root:Accuracy of  ship : 54.90 %
INFO:root:Accuracy of truck : 96.50 %
INFO:root:
Test set: Average loss: 0.0019, Accuracy: 5637/10000 (56.37%)

INFO:root:#### Targetted Accuracy of truck : 100.00 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 6 |, is 2.4850404262542725
INFO:root:@@@@@@@@ Working on client (global-index): 50, which 8-th user in the current round
INFO:root:Effective lr in FL round: 6 is 0.01980079840159936
INFO:root:Train Epoch: 1 [0/389 (0%)]	Loss: 1.586454
INFO:root:Train Epoch: 2 [0/389 (0%)]	Loss: 1.481607
INFO:root:Train Epoch: 3 [0/389 (0%)]	Loss: 1.492396
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 6 |, is 0.8104123473167419
INFO:root:@@@@@@@@ Working on client (global-index): 35, which 9-th user in the current round
INFO:root:Effective lr in FL round: 6 is 0.01980079840159936
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 1.765014
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.668428
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.624983
INFO:root:Accuracy of plane : 33.40 %
INFO:root:Accuracy of   car : 71.90 %
INFO:root:Accuracy of  bird : 35.70 %
INFO:root:Accuracy of   cat : 47.20 %
INFO:root:Accuracy of  deer : 45.90 %
INFO:root:Accuracy of   dog : 83.30 %
INFO:root:Accuracy of  frog : 66.50 %
INFO:root:Accuracy of horse : 78.60 %
INFO:root:Accuracy of  ship : 34.00 %
INFO:root:Accuracy of truck : 92.30 %
INFO:root:
Test set: Average loss: 0.0019, Accuracy: 5888/10000 (58.88%)

INFO:root:#### Targetted Accuracy of truck : 100.00 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 6 |, is 2.4594058990478516
INFO:root:@@@@@@@@ Working on client (global-index): 70, which 10-th user in the current round
INFO:root:Effective lr in FL round: 6 is 0.01980079840159936
INFO:root:Train Epoch: 1 [0/336 (0%)]	Loss: 1.641191
INFO:root:Train Epoch: 2 [0/336 (0%)]	Loss: 1.580026
INFO:root:Train Epoch: 3 [0/336 (0%)]	Loss: 1.579275
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 6 |, is 1.0852466821670532
INFO:root:@@@@@@@@ Working on client (global-index): 84, which 11-th user in the current round
INFO:root:Effective lr in FL round: 6 is 0.01980079840159936
INFO:root:Train Epoch: 1 [0/350 (0%)]	Loss: 1.590185
INFO:root:Train Epoch: 2 [0/350 (0%)]	Loss: 1.489133
INFO:root:Train Epoch: 3 [0/350 (0%)]	Loss: 1.569968
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 6 |, is 1.1214627027511597
INFO:root:@@@@@@@@ Working on client (global-index): 8, which 12-th user in the current round
INFO:root:Effective lr in FL round: 6 is 0.01980079840159936
INFO:root:Train Epoch: 1 [0/395 (0%)]	Loss: 1.562973
INFO:root:Train Epoch: 2 [0/395 (0%)]	Loss: 1.594398
INFO:root:Train Epoch: 3 [0/395 (0%)]	Loss: 1.565486
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 6 |, is 1.4667620658874512
INFO:root:@@@@@@@@ Working on client (global-index): 26, which 13-th user in the current round
INFO:root:Effective lr in FL round: 6 is 0.01980079840159936
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 1.965919
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.620122
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.664151
INFO:root:Accuracy of plane : 40.00 %
INFO:root:Accuracy of   car : 80.50 %
INFO:root:Accuracy of  bird : 47.50 %
INFO:root:Accuracy of   cat : 38.60 %
INFO:root:Accuracy of  deer : 49.10 %
INFO:root:Accuracy of   dog : 79.00 %
INFO:root:Accuracy of  frog : 75.40 %
INFO:root:Accuracy of horse : 88.70 %
INFO:root:Accuracy of  ship : 89.00 %
INFO:root:Accuracy of truck : 87.20 %
INFO:root:
Test set: Average loss: 0.0018, Accuracy: 6750/10000 (67.50%)

INFO:root:#### Targetted Accuracy of truck : 98.47 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 6 |, is 2.0933122634887695
INFO:root:@@@@@@@@ Working on client (global-index): 97, which 14-th user in the current round
INFO:root:Effective lr in FL round: 6 is 0.01980079840159936
INFO:root:Train Epoch: 1 [0/293 (0%)]	Loss: 1.697264
INFO:root:Train Epoch: 2 [0/293 (0%)]	Loss: 1.590084
INFO:root:Train Epoch: 3 [0/293 (0%)]	Loss: 1.653265
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 6 |, is 1.6668742895126343
INFO:root:@@@@@@@@ Working on client (global-index): 53, which 15-th user in the current round
INFO:root:Effective lr in FL round: 6 is 0.01980079840159936
INFO:root:Train Epoch: 1 [0/180 (0%)]	Loss: 1.614577
INFO:root:Train Epoch: 2 [0/180 (0%)]	Loss: 1.478134
INFO:root:Train Epoch: 3 [0/180 (0%)]	Loss: 1.582532
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 6 |, is 0.9115415811538696
INFO:root:@@@@@@@@ Working on client (global-index): 77, which 16-th user in the current round
INFO:root:Effective lr in FL round: 6 is 0.01980079840159936
INFO:root:Train Epoch: 1 [0/342 (0%)]	Loss: 1.558904
INFO:root:Train Epoch: 2 [0/342 (0%)]	Loss: 1.461846
INFO:root:Train Epoch: 3 [0/342 (0%)]	Loss: 1.461218
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 6 |, is 0.8864616751670837
INFO:root:@@@@@@@@ Working on client (global-index): 9, which 17-th user in the current round
INFO:root:Effective lr in FL round: 6 is 0.01980079840159936
INFO:root:Train Epoch: 1 [0/337 (0%)]	Loss: 1.564009
INFO:root:Train Epoch: 2 [0/337 (0%)]	Loss: 1.462534
INFO:root:Train Epoch: 3 [0/337 (0%)]	Loss: 1.473102
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 6 |, is 1.084454894065857
INFO:root:@@@@@@@@ Working on client (global-index): 38, which 18-th user in the current round
INFO:root:Effective lr in FL round: 6 is 0.01980079840159936
INFO:root:Train Epoch: 1 [0/394 (0%)]	Loss: 1.649982
INFO:root:Train Epoch: 2 [0/394 (0%)]	Loss: 1.510465
INFO:root:Train Epoch: 3 [0/394 (0%)]	Loss: 1.584557
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 6 |, is 1.291385531425476
INFO:root:@@@@@@@@ Working on client (global-index): 46, which 19-th user in the current round
INFO:root:Effective lr in FL round: 6 is 0.01980079840159936
INFO:root:Train Epoch: 1 [0/387 (0%)]	Loss: 1.642326
INFO:root:Train Epoch: 2 [0/387 (0%)]	Loss: 1.547697
INFO:root:Train Epoch: 3 [0/387 (0%)]	Loss: 1.487822
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 6 |, is 1.1949396133422852
INFO:root:@@@@@@@@ Working on client (global-index): 147, which 20-th user in the current round
INFO:root:Effective lr in FL round: 6 is 0.01980079840159936
INFO:root:Train Epoch: 1 [0/331 (0%)]	Loss: 1.678164
INFO:root:Train Epoch: 2 [0/331 (0%)]	Loss: 1.670871
INFO:root:Train Epoch: 3 [0/331 (0%)]	Loss: 1.589536
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 6 |, is 1.214093565940857
INFO:root:@@@@@@@@ Working on client (global-index): 27, which 21-th user in the current round
INFO:root:Effective lr in FL round: 6 is 0.01980079840159936
INFO:root:Train Epoch: 1 [0/294 (0%)]	Loss: 1.598995
INFO:root:Train Epoch: 2 [0/294 (0%)]	Loss: 1.607598
INFO:root:Train Epoch: 3 [0/294 (0%)]	Loss: 1.612399
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 6 |, is 1.1308152675628662
INFO:root:@@@@@@@@ Working on client (global-index): 34, which 22-th user in the current round
INFO:root:Effective lr in FL round: 6 is 0.01980079840159936
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 1.874930
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.703527
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.733055
Total computation time of the 2nd layer is: 340.03955078125
[Final-result] predicted suspicious set is: [19, 26, 135]
verifier: 7, true positive: 1.0, true negative: 0.75, false positive: 0.25

predict honest: [25, 100, 75]

predict attacker: [19, 26, 135]

true attacker: [19, 26]

------------------------------------------------------------------------------------
epsilon_1:  0.5
[Soft-filter] predicted suspicious set is:  [26, 90, 121]
Total computation time of the 1st layer is: 2.036865234375
[Hard-filter] predicted suspicious set is:  [26, 90, 121]
Total computation time of the 2nd layer is: 333.76220703125
[Final-result] predicted suspicious set is: [26, 90, 121]
verifier: 8, true positive: 1.0, true negative: 1.0, false positive: 0.0

predict honest: [74, 104, 94]

predict attacker: [26, 90, 121]

true attacker: [26, 90, 121]

------------------------------------------------------------------------------------
epsilon_1:  0.29876153653068505
[Soft-filter] predicted suspicious set is:  [41, 115, 14]
Total computation time of the 1st layer is: 1.58935546875
[Hard-filter] predicted suspicious set is:  [115, 14, 69]
Total computation time of the 2nd layer is: 338.166748046875
[Final-result] predicted suspicious set is: [41, 115, 14]
verifier: 9, true positive: 1.0, true negative: 0.6, false positive: 0.4

predict honest: [45, 100, 69]

predict attacker: [41, 115, 14]

true attacker: [14]

------------------------------------------------------------------------------------
epsilon_1:  0.3185110264450712
[Soft-filter] predicted suspicious set is:  [11, 135, 116]
Total computation time of the 1st layer is: 1.644775390625
[Hard-filter] predicted suspicious set is:  [74, 69, 116]
Total computation time of the 2nd layer is: 339.529541015625
[Final-result] predicted suspicious set is: [11, 135, 116]
verifier: 10, true positive: 1.0, true negative: 0.6, false positive: 0.4

predict honest: [74, 45, 69]

predict attacker: [11, 135, 116]

true attacker: [11]

------------------------------------------------------------------------------------
epsilon_1:  0.38085924200367804
[Soft-filter] predicted suspicious set is:  [49, 116, 118]
Total computation time of the 1st layer is: 1.713134765625
[Hard-filter] predicted suspicious set is:  [49, 118]
Total computation time of the 2nd layer is: 342.467529296875
[Final-result] predicted suspicious set is: [49, 116, 118]
verifier: 11, true positive: 1.0, true negative: 0.6, false positive: 0.4

predict honest: [38, 115, 104]

predict attacker: [49, 116, 118]

true attacker: [118]

------------------------------------------------------------------------------------
epsilon_1:  0.45838904673039743
[Soft-filter] predicted suspicious set is:  [49, 61, 41]
Total computation time of the 1st layer is: 1.726318359375
[Hard-filter] predicted suspicious set is:  [104, 22, 119]
Total computation time of the 2nd layer is: 332.5849609375
[Final-result] predicted suspicious set is: [49, 61, 41]
verifier: 12, true positive: 1.0, true negative: 0.5, false positive: 0.5

predict honest: [104, 22, 119]

predict attacker: [49, 61, 41]

true attacker: []

------------------------------------------------------------------------------------
epsilon_1:  0.2347476897782332
[Soft-filter] predicted suspicious set is:  [85, 135, 115]
Total computation time of the 1st layer is: 1.466796875
[Hard-filter] predicted suspicious set is:  [85, 135]
Total computation time of the 2nd layer is: 334.745361328125
[Final-result] predicted suspicious set is: [85, 135, 115]
verifier: 13, true positive: 1.0, true negative: 0.5, false positive: 0.5

predict honest: [94, 76, 22]

predict attacker: [85, 135, 115]

true attacker: []

------------------------------------------------------------------------------------
epsilon_1:  0.5
[Soft-filter] predicted suspicious set is:  [49, 98, 37, 61]
Total computation time of the 1st layer is: 1.41015625
[Hard-filter] predicted suspicious set is:  [38, 76]
Total computation time of the 2nd layer is: 333.60400390625
[Final-result] predicted suspicious set is: [49, 98, 37, 61]
verifier: 14, true positive: 1.0, true negative: 0.5, false positive: 0.5

predict honest: [38, 76]

predict attacker: [49, 98, 37, 61]

true attacker: [98, 37]

------------------------------------------------------------------------------------
Flr: 5, number verifier: 15, clients/verifier: 6, attacked verifier: 4

Flr: 5, true positive: 1.0, true negative: 0.5714285714285714, false positive: 0.42857142857142855

Flr: 5, honest client after all verify: [22, 100, 69, 45, 104, 94, 38, 75, 74, 25, 76, 119]
Flr: 5, attackers: [26, 118, 90, 37, 14, 98, 19, 11, 121]
Flr: 5, number not verify: 2
num_data_points:  [600, 343, 130, 600, 405, 340, 392, 600, 389, 600, 336, 350, 395, 600, 293, 180, 342, 337, 394, 387, 331, 294, 600, 600, 192, 379, 212, 404, 246, 264]
total_num_dps_per_round: 11535
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
wandb: Waiting for W&B process to finish... (failed 255). Press Control-C to abort syncing.
wandb: 🚀 View run benchmark at: https://wandb.ai/aiotlab/Backdoor%20attack%20in%20FL/runs/nny1wfoj
wandb: Synced 6 W&B file(s), 0 media file(s), 2 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20230526_144859-nny1wfoj/logs
