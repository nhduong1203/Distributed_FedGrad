INFO:root:Running Attack of the tails with args: Namespace(adv_lr=0.02, adversarial_local_training_period=3, attack_case='edge-case', attack_method='blackbox', attacker_percent=0.25, attacker_pool_size=100, batch_size=32, clients_per_verifier=5, dataset='cifar10', defense_method='fedgrad', degree_nonIID=0.5, device='cuda:3', epochs=14, eps=2.0, fl_mode='fixed-pool', fl_round=500, fraction=0.1, gamma=0.998, instance='my_server_test', local_train_period=3, log_folder='logging', log_interval=100, lr=0.02, malicious_verifier='random', model='vgg9', model_replacement=False, no_cuda=False, norm_bound=2.0, num_nets=200, number_verifiers=23, part_nets_per_round=30, pdr=0.33, poison_type='southwest', project_frequency=10, prox_attack=False, rand_seed=7, randomChoose=True, seed=1, stddev=0.025, test_batch_size=1000, updateSelection=True, use_trustworthy=True, wandb_group='TestingGroup')
INFO:root:cuda:3
INFO:root:==> Building model..
INFO:root:Seeded everything
INFO:root:OOD (Southwest Airline) train-data shape we collected: (784, 32, 32, 3)
INFO:root:OOD (Southwest Airline) test-data shape we collected: (196, 32, 32, 3)
INFO:root:!!!!!!!!!!!Num poisoned data points in the mixed dataset: 200
INFO:root:!!!!!!!!!!!Num clean data points in the mixed dataset: 400
INFO:root:(600, 32, 32, 3)
INFO:root:(600,)
INFO:root:3695
INFO:root:GET_VGG_MODEL: Fetch vgg9
INFO:root:Loading checkpoint file successfully ...
INFO:root:Test the model performance on the entire task before FL process ... 
INFO:root:Accuracy of plane : 76.70 %
INFO:root:Accuracy of   car : 90.20 %
INFO:root:Accuracy of  bird : 49.00 %
INFO:root:Accuracy of   cat : 56.50 %
INFO:root:Accuracy of  deer : 75.00 %
INFO:root:Accuracy of   dog : 75.70 %
INFO:root:Accuracy of  frog : 92.60 %
INFO:root:Accuracy of horse : 83.60 %
INFO:root:Accuracy of  ship : 81.50 %
INFO:root:Accuracy of truck : 94.50 %
INFO:root:
Test set: Average loss: 0.0017, Accuracy: 7753/10000 (77.53%)

INFO:root:#### Targetted Accuracy of truck : 11.22 %
wandb: Currently logged in as: levi2k1 (aiotlab). Use `wandb login --relogin` to force relogin
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
2023-06-15 13:01:19.052692: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F AVX512_VNNI FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-06-15 13:01:19.197982: I tensorflow/core/util/util.cc:169] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2023-06-15 13:01:19.234795: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2023-06-15 13:01:19.858092: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /mnt/disk1/anaconda3/envs/longnd/lib/python3.7/site-packages/cv2/../../lib64::/usr/local/cuda-11.0/lib64:/usr/local/cuda/extras/CUPTI/lib64:/usr/local/cuda-11.0/lib64:/usr/local/cuda/extras/CUPTI/lib64:/usr/local/cuda-11.0/lib64:/usr/local/cuda/extras/CUPTI/lib64
2023-06-15 13:01:19.858129: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
wandb: wandb version 0.15.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.12.16
wandb: Run data is saved locally in /mnt/disk1/duongnh/Distributed_FedGrad/wandb/run-20230615_130116-20cx7xvk
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run my_server_test
wandb: â­ï¸ View project at https://wandb.ai/aiotlab/Distributed%20Backdoor%20Attack%20FedGrad
wandb: ðŸš€ View run at https://wandb.ai/aiotlab/Distributed%20Backdoor%20Attack%20FedGrad/runs/20cx7xvk
INFO:root:Posion type! southwest
INFO:root:Selected Attackers in FL iteration-1: [138, 24, 109, 71, 147, 9, 129, 102]
INFO:root:################## Starting fl round: 1
INFO:root:@@@@@@@@ Working on client (global-index): 138, which 0-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 1.833434
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.654265
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.580153
INFO:root:Accuracy of plane : 71.50 %
INFO:root:Accuracy of   car : 82.10 %
INFO:root:Accuracy of  bird : 71.90 %
INFO:root:Accuracy of   cat : 54.10 %
INFO:root:Accuracy of  deer : 77.00 %
INFO:root:Accuracy of   dog : 58.90 %
INFO:root:Accuracy of  frog : 88.30 %
INFO:root:Accuracy of horse : 78.50 %
INFO:root:Accuracy of  ship : 86.30 %
INFO:root:Accuracy of truck : 82.90 %
INFO:root:
Test set: Average loss: 0.0017, Accuracy: 7515/10000 (75.15%)

INFO:root:#### Targetted Accuracy of truck : 92.35 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 1 |, is 1.91779363155365
INFO:root:@@@@@@@@ Working on client (global-index): 14, which 1-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/398 (0%)]	Loss: 1.592083
INFO:root:Train Epoch: 2 [0/398 (0%)]	Loss: 1.564737
INFO:root:Train Epoch: 3 [0/398 (0%)]	Loss: 1.607461
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 1 |, is 1.3061858415603638
INFO:root:@@@@@@@@ Working on client (global-index): 113, which 2-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/169 (0%)]	Loss: 1.759922
INFO:root:Train Epoch: 2 [0/169 (0%)]	Loss: 1.639235
INFO:root:Train Epoch: 3 [0/169 (0%)]	Loss: 1.680225
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 1 |, is 0.7088404893875122
INFO:root:@@@@@@@@ Working on client (global-index): 153, which 3-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/285 (0%)]	Loss: 1.763067
INFO:root:Train Epoch: 2 [0/285 (0%)]	Loss: 1.752072
INFO:root:Train Epoch: 3 [0/285 (0%)]	Loss: 1.569461
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 1 |, is 1.0062354803085327
INFO:root:@@@@@@@@ Working on client (global-index): 24, which 4-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 1.862782
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.613431
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.617742
INFO:root:Accuracy of plane : 37.60 %
INFO:root:Accuracy of   car : 78.50 %
INFO:root:Accuracy of  bird : 68.90 %
INFO:root:Accuracy of   cat : 52.30 %
INFO:root:Accuracy of  deer : 51.20 %
INFO:root:Accuracy of   dog : 80.50 %
INFO:root:Accuracy of  frog : 85.60 %
INFO:root:Accuracy of horse : 83.30 %
INFO:root:Accuracy of  ship : 74.50 %
INFO:root:Accuracy of truck : 91.30 %
INFO:root:
Test set: Average loss: 0.0018, Accuracy: 7037/10000 (70.37%)

INFO:root:#### Targetted Accuracy of truck : 98.98 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 1 |, is 1.94850492477417
INFO:root:@@@@@@@@ Working on client (global-index): 137, which 5-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/321 (0%)]	Loss: 1.647664
INFO:root:Train Epoch: 2 [0/321 (0%)]	Loss: 1.492432
INFO:root:Train Epoch: 3 [0/321 (0%)]	Loss: 1.482349
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 1 |, is 0.9312189221382141
INFO:root:@@@@@@@@ Working on client (global-index): 126, which 6-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/201 (0%)]	Loss: 1.657543
INFO:root:Train Epoch: 2 [0/201 (0%)]	Loss: 1.534669
INFO:root:Train Epoch: 3 [0/201 (0%)]	Loss: 1.617809
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 1 |, is 0.9814258217811584
INFO:root:@@@@@@@@ Working on client (global-index): 109, which 7-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 1.944873
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.715095
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.614220
INFO:root:Accuracy of plane : 44.40 %
INFO:root:Accuracy of   car : 46.90 %
INFO:root:Accuracy of  bird : 57.00 %
INFO:root:Accuracy of   cat : 74.10 %
INFO:root:Accuracy of  deer : 77.00 %
INFO:root:Accuracy of   dog : 45.90 %
INFO:root:Accuracy of  frog : 73.00 %
INFO:root:Accuracy of horse : 79.20 %
INFO:root:Accuracy of  ship : 85.20 %
INFO:root:Accuracy of truck : 95.90 %
INFO:root:
Test set: Average loss: 0.0018, Accuracy: 6786/10000 (67.86%)

INFO:root:#### Targetted Accuracy of truck : 98.47 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 1 |, is 1.9836515188217163
INFO:root:@@@@@@@@ Working on client (global-index): 6, which 8-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/313 (0%)]	Loss: 1.650475
INFO:root:Train Epoch: 2 [0/313 (0%)]	Loss: 1.592783
INFO:root:Train Epoch: 3 [0/313 (0%)]	Loss: 1.504502
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 1 |, is 1.1234588623046875
INFO:root:@@@@@@@@ Working on client (global-index): 44, which 9-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/285 (0%)]	Loss: 1.844741
INFO:root:Train Epoch: 2 [0/285 (0%)]	Loss: 1.654122
INFO:root:Train Epoch: 3 [0/285 (0%)]	Loss: 1.785310
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 1 |, is 0.9977009892463684
INFO:root:@@@@@@@@ Working on client (global-index): 71, which 10-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 2.018303
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.552010
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.610451
INFO:root:Accuracy of plane : 73.00 %
INFO:root:Accuracy of   car : 70.40 %
INFO:root:Accuracy of  bird : 58.80 %
INFO:root:Accuracy of   cat : 64.80 %
INFO:root:Accuracy of  deer : 90.20 %
INFO:root:Accuracy of   dog : 55.60 %
INFO:root:Accuracy of  frog : 76.80 %
INFO:root:Accuracy of horse : 74.30 %
INFO:root:Accuracy of  ship : 93.10 %
INFO:root:Accuracy of truck : 69.60 %
INFO:root:
Test set: Average loss: 0.0017, Accuracy: 7266/10000 (72.66%)

INFO:root:#### Targetted Accuracy of truck : 79.08 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 1 |, is 2.0435116291046143
INFO:root:@@@@@@@@ Working on client (global-index): 45, which 11-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/110 (0%)]	Loss: 1.856224
INFO:root:Train Epoch: 2 [0/110 (0%)]	Loss: 1.579180
INFO:root:Train Epoch: 3 [0/110 (0%)]	Loss: 1.677878
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 1 |, is 0.6550631523132324
INFO:root:@@@@@@@@ Working on client (global-index): 197, which 12-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/194 (0%)]	Loss: 1.686267
INFO:root:Train Epoch: 2 [0/194 (0%)]	Loss: 1.633861
INFO:root:Train Epoch: 3 [0/194 (0%)]	Loss: 1.556711
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 1 |, is 0.8237051963806152
INFO:root:@@@@@@@@ Working on client (global-index): 63, which 13-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/293 (0%)]	Loss: 1.922029
INFO:root:Train Epoch: 2 [0/293 (0%)]	Loss: 1.594406
INFO:root:Train Epoch: 3 [0/293 (0%)]	Loss: 1.600839
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 1 |, is 1.2578520774841309
INFO:root:@@@@@@@@ Working on client (global-index): 147, which 14-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 2.018311
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.625580
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.565458
INFO:root:Accuracy of plane : 31.70 %
INFO:root:Accuracy of   car : 69.20 %
INFO:root:Accuracy of  bird : 66.60 %
INFO:root:Accuracy of   cat : 62.10 %
INFO:root:Accuracy of  deer : 74.70 %
INFO:root:Accuracy of   dog : 62.50 %
INFO:root:Accuracy of  frog : 81.80 %
INFO:root:Accuracy of horse : 70.90 %
INFO:root:Accuracy of  ship : 79.60 %
INFO:root:Accuracy of truck : 89.00 %
INFO:root:
Test set: Average loss: 0.0018, Accuracy: 6881/10000 (68.81%)

INFO:root:#### Targetted Accuracy of truck : 100.00 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 1 |, is 2.060396671295166
INFO:root:@@@@@@@@ Working on client (global-index): 9, which 15-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 1.939478
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.627573
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.626080
INFO:root:Accuracy of plane : 57.00 %
INFO:root:Accuracy of   car : 60.30 %
INFO:root:Accuracy of  bird : 71.80 %
INFO:root:Accuracy of   cat : 35.40 %
INFO:root:Accuracy of  deer : 90.40 %
INFO:root:Accuracy of   dog : 71.40 %
INFO:root:Accuracy of  frog : 73.90 %
INFO:root:Accuracy of horse : 66.50 %
INFO:root:Accuracy of  ship : 76.40 %
INFO:root:Accuracy of truck : 91.30 %
INFO:root:
Test set: Average loss: 0.0018, Accuracy: 6944/10000 (69.44%)

INFO:root:#### Targetted Accuracy of truck : 98.47 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 1 |, is 2.0975072383880615
INFO:root:@@@@@@@@ Working on client (global-index): 54, which 16-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/221 (0%)]	Loss: 1.613104
INFO:root:Train Epoch: 2 [0/221 (0%)]	Loss: 1.555756
INFO:root:Train Epoch: 3 [0/221 (0%)]	Loss: 1.504974
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 1 |, is 0.7537183165550232
INFO:root:@@@@@@@@ Working on client (global-index): 64, which 17-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/234 (0%)]	Loss: 1.731145
INFO:root:Train Epoch: 2 [0/234 (0%)]	Loss: 1.571835
INFO:root:Train Epoch: 3 [0/234 (0%)]	Loss: 1.552662
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 1 |, is 0.8927306532859802
INFO:root:@@@@@@@@ Working on client (global-index): 58, which 18-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/300 (0%)]	Loss: 1.732226
INFO:root:Train Epoch: 2 [0/300 (0%)]	Loss: 1.536203
INFO:root:Train Epoch: 3 [0/300 (0%)]	Loss: 1.519903
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 1 |, is 1.1404651403427124
INFO:root:@@@@@@@@ Working on client (global-index): 4, which 19-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/370 (0%)]	Loss: 1.703480
INFO:root:Train Epoch: 2 [0/370 (0%)]	Loss: 1.697071
INFO:root:Train Epoch: 3 [0/370 (0%)]	Loss: 1.568157
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 1 |, is 1.2250906229019165
INFO:root:@@@@@@@@ Working on client (global-index): 124, which 20-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/284 (0%)]	Loss: 1.682591
INFO:root:Train Epoch: 2 [0/284 (0%)]	Loss: 1.630785
INFO:root:Train Epoch: 3 [0/284 (0%)]	Loss: 1.541207
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 1 |, is 1.0786128044128418
INFO:root:@@@@@@@@ Working on client (global-index): 66, which 21-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/168 (0%)]	Loss: 1.762571
INFO:root:Train Epoch: 2 [0/168 (0%)]	Loss: 1.693815
INFO:root:Train Epoch: 3 [0/168 (0%)]	Loss: 1.635076
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 1 |, is 0.6587085127830505
INFO:root:@@@@@@@@ Working on client (global-index): 62, which 22-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/299 (0%)]	Loss: 1.833764
INFO:root:Train Epoch: 2 [0/299 (0%)]	Loss: 1.500700
INFO:root:Train Epoch: 3 [0/299 (0%)]	Loss: 1.497954
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 1 |, is 1.5637673139572144
INFO:root:@@@@@@@@ Working on client (global-index): 134, which 23-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/151 (0%)]	Loss: 1.760262
INFO:root:Train Epoch: 2 [0/151 (0%)]	Loss: 1.614425
INFO:root:Train Epoch: 3 [0/151 (0%)]	Loss: 1.513086
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 1 |, is 0.7023683190345764
INFO:root:@@@@@@@@ Working on client (global-index): 101, which 24-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/375 (0%)]	Loss: 1.689121
INFO:root:Train Epoch: 2 [0/375 (0%)]	Loss: 1.504681
INFO:root:Train Epoch: 3 [0/375 (0%)]	Loss: 1.470971
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 1 |, is 1.252854824066162
INFO:root:@@@@@@@@ Working on client (global-index): 129, which 25-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 1.931226
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.759356
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.657242
INFO:root:Accuracy of plane : 36.10 %
INFO:root:Accuracy of   car : 69.40 %
INFO:root:Accuracy of  bird : 69.20 %
INFO:root:Accuracy of   cat : 59.90 %
INFO:root:Accuracy of  deer : 50.60 %
INFO:root:Accuracy of   dog : 62.30 %
INFO:root:Accuracy of  frog : 92.40 %
INFO:root:Accuracy of horse : 77.00 %
INFO:root:Accuracy of  ship : 95.40 %
INFO:root:Accuracy of truck : 85.00 %
INFO:root:
Test set: Average loss: 0.0018, Accuracy: 6973/10000 (69.73%)

INFO:root:#### Targetted Accuracy of truck : 86.73 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 1 |, is 1.9534591436386108
INFO:root:@@@@@@@@ Working on client (global-index): 50, which 26-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/282 (0%)]	Loss: 1.887130
INFO:root:Train Epoch: 2 [0/282 (0%)]	Loss: 1.757895
INFO:root:Train Epoch: 3 [0/282 (0%)]	Loss: 1.556412
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 1 |, is 1.0926545858383179
INFO:root:@@@@@@@@ Working on client (global-index): 102, which 27-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 2.013005
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.671435
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.572312
INFO:root:Accuracy of plane : 79.80 %
INFO:root:Accuracy of   car : 87.30 %
INFO:root:Accuracy of  bird : 54.40 %
INFO:root:Accuracy of   cat : 65.00 %
INFO:root:Accuracy of  deer : 85.30 %
INFO:root:Accuracy of   dog : 62.60 %
INFO:root:Accuracy of  frog : 72.50 %
INFO:root:Accuracy of horse : 84.20 %
INFO:root:Accuracy of  ship : 82.50 %
INFO:root:Accuracy of truck : 80.30 %
INFO:root:
Test set: Average loss: 0.0017, Accuracy: 7539/10000 (75.39%)

INFO:root:#### Targetted Accuracy of truck : 88.27 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 1 |, is 2.055783271789551
INFO:root:@@@@@@@@ Working on client (global-index): 158, which 28-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/193 (0%)]	Loss: 1.679185
INFO:root:Train Epoch: 2 [0/193 (0%)]	Loss: 1.583938
INFO:root:Train Epoch: 3 [0/193 (0%)]	Loss: 1.727290
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 1 |, is 2.360088348388672
INFO:root:@@@@@@@@ Working on client (global-index): 21, which 29-th user in the current round
INFO:root:Effective lr in FL round: 1 is 0.02
INFO:root:Train Epoch: 1 [0/251 (0%)]	Loss: 1.778102
INFO:root:Train Epoch: 2 [0/251 (0%)]	Loss: 1.571793
INFO:root:Train Epoch: 3 [0/251 (0%)]	Loss: 1.576966
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 1 |, is 0.9759279489517212
INFO:root:GET_VGG_MODEL: Fetch vgg9
num_data_points:  [600, 398, 169, 285, 600, 321, 201, 600, 313, 285, 600, 110, 194, 293, 600, 600, 221, 234, 300, 370, 284, 168, 299, 151, 375, 600, 282, 600, 193, 251]
total_num_dps_per_round: 10497
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
verifier set:  [41, 19, 50, 83, 6, 9, 68, 12, 46, 74, 7, 64, 27, 4, 11, 55, 53, 8, 30, 85, 70, 54, 89]
epsilon_1:  0.5
[Soft-filter] predicted suspicious set is:  [50, 109, 124]
Total computation time of the 1st layer is: 1.8466796875
[Hard-filter] predicted suspicious set is:  [50, 109]
Total computation time of the 2nd layer is: 269.319580078125
[Final-result] predicted suspicious set is: [50, 109, 124]
verifier: 0, true positive: 1.0, true negative: 0.5, false positive: 0.5

------------------------------------------------------------------------------------
epsilon_1:  0.245145740294695
[Soft-filter] predicted suspicious set is:  [197, 109]
Total computation time of the 1st layer is: 1.417236328125
[Hard-filter] predicted suspicious set is:  [58, 197]
Total computation time of the 2nd layer is: 216.01220703125
[Final-result] predicted suspicious set is: [197, 109]
verifier: 1, true positive: 1.0, true negative: 0.75, false positive: 0.25

------------------------------------------------------------------------------------
epsilon_1:  0.5
[Soft-filter] predicted suspicious set is:  [102, 24, 63]
Total computation time of the 1st layer is: 1.304443359375
[Hard-filter] predicted suspicious set is:  [102, 24]
Total computation time of the 2nd layer is: 220.638671875
[Final-result] predicted suspicious set is: [102, 24, 63]
verifier: 2, true positive: 1.0, true negative: 0.6666666666666667, false positive: 0.3333333333333333

------------------------------------------------------------------------------------
epsilon_1:  0.027751125023404155
[Soft-filter] predicted suspicious set is:  [64, 50]
Total computation time of the 1st layer is: 1.269775390625
[Hard-filter] predicted suspicious set is:  [153, 58]
Total computation time of the 2nd layer is: 216.5205078125
[Final-result] predicted suspicious set is: [64, 50]
verifier: 3, true positive: 1.0, true negative: 0.6, false positive: 0.4

------------------------------------------------------------------------------------
epsilon_1:  0.2985072575177852
[Soft-filter] predicted suspicious set is:  [153, 124]
Total computation time of the 1st layer is: 1.16796875
[Hard-filter] predicted suspicious set is:  [58, 124]
Total computation time of the 2nd layer is: 214.7724609375
[Final-result] predicted suspicious set is: [153, 124]
verifier: 4, true positive: 1.0, true negative: 0.6, false positive: 0.4

------------------------------------------------------------------------------------
epsilon_1:  0.36460491216518315
[Soft-filter] predicted suspicious set is:  [64, 62]
Total computation time of the 1st layer is: 1.166259765625
[Hard-filter] predicted suspicious set is:  [62]
Total computation time of the 2nd layer is: 219.321533203125
[Final-result] predicted suspicious set is: [64, 62]
verifier: 5, true positive: 1.0, true negative: 0.6, false positive: 0.4

------------------------------------------------------------------------------------
epsilon_1:  0.45510636400704474
[Soft-filter] predicted suspicious set is:  [4, 9]
Total computation time of the 1st layer is: 1.451416015625
[Hard-filter] predicted suspicious set is:  [4, 64]
Total computation time of the 2nd layer is: 218.432861328125
[Final-result] predicted suspicious set is: [4, 9]
verifier: 6, true positive: 1.0, true negative: 0.75, false positive: 0.25

------------------------------------------------------------------------------------
epsilon_1:  0.5
[Soft-filter] predicted suspicious set is:  [63, 101, 71, 147]
Total computation time of the 1st layer is: 1.226806640625
[Hard-filter] predicted suspicious set is:  [71, 147]
Total computation time of the 2nd layer is: 217.377685546875
[Final-result] predicted suspicious set is: [63, 101, 71, 147]
verifier: 7, true positive: 1.0, true negative: 0.33333333333333337, false positive: 0.6666666666666666

------------------------------------------------------------------------------------
epsilon_1:  0.5
[Soft-filter] predicted suspicious set is:  [21, 147, 109]
Total computation time of the 1st layer is: 1.453857421875
[Hard-filter] predicted suspicious set is:  [147, 109]
Total computation time of the 2nd layer is: 239.12744140625
[Final-result] predicted suspicious set is: [21, 147, 109]
verifier: 8, true positive: 1.0, true negative: 0.6666666666666667, false positive: 0.3333333333333333

------------------------------------------------------------------------------------
epsilon_1:  0.5
[Soft-filter] predicted suspicious set is:  [129, 101, 109]
Total computation time of the 1st layer is: 1.275634765625
[Hard-filter] predicted suspicious set is:  [129, 109]
Total computation time of the 2nd layer is: 229.928466796875
[Final-result] predicted suspicious set is: [129, 101, 109]
verifier: 9, true positive: 1.0, true negative: 0.6666666666666667, false positive: 0.3333333333333333

------------------------------------------------------------------------------------
epsilon_1:  0.27159167237777715
[Soft-filter] predicted suspicious set is:  [44, 9]
Total computation time of the 1st layer is: 1.289306640625
[Hard-filter] predicted suspicious set is:  [44, 9]
Total computation time of the 2nd layer is: 233.830810546875
[Final-result] predicted suspicious set is: [44, 9]
verifier: 10, true positive: 1.0, true negative: 0.75, false positive: 0.25

------------------------------------------------------------------------------------
epsilon_1:  0.2701331568130686
[Soft-filter] predicted suspicious set is:  [71, 147]
Total computation time of the 1st layer is: 1.546142578125
[Hard-filter] predicted suspicious set is:  [158, 71, 147]
Total computation time of the 2nd layer is: 264.257080078125
[Final-result] predicted suspicious set is: [71, 147]
verifier: 11, true positive: 1.0, true negative: 1.0, false positive: 0.0

------------------------------------------------------------------------------------
epsilon_1:  0.3646081128395606
[Soft-filter] predicted suspicious set is:  [4, 63]
Total computation time of the 1st layer is: 1.494140625
[Hard-filter] predicted suspicious set is:  [4, 63]
Total computation time of the 2nd layer is: 231.732421875
[Final-result] predicted suspicious set is: [4, 63]
verifier: 12, true positive: 1.0, true negative: 0.6, false positive: 0.4

------------------------------------------------------------------------------------
epsilon_1: INFO:root:GET_VGG_MODEL: Fetch vgg9
INFO:root:===> ND `|w_avg-w_g|` in local epoch: 0 | FL round: 1 |, is 0.0
INFO:root:Measuring the accuracy of the averaged global model, FL round: 1 ...
INFO:root:Accuracy of plane : 85.70 %
INFO:root:Accuracy of   car : 94.20 %
INFO:root:Accuracy of  bird : 59.20 %
INFO:root:Accuracy of   cat : 59.90 %
INFO:root:Accuracy of  deer : 84.20 %
INFO:root:Accuracy of   dog : 66.60 %
INFO:root:Accuracy of  frog : 93.00 %
INFO:root:Accuracy of horse : 80.80 %
INFO:root:Accuracy of  ship : 94.70 %
INFO:root:Accuracy of truck : 86.60 %
INFO:root:
Test set: Average loss: 0.0017, Accuracy: 8049/10000 (80.49%)

INFO:root:#### Targetted Accuracy of truck : 5.10 %
INFO:root:Selected Attackers in FL iteration-2: [60, 140, 172, 152, 93, 65]
INFO:root:################## Starting fl round: 2
INFO:root:@@@@@@@@ Working on client (global-index): 162, which 0-th user in the current round
INFO:root:Effective lr in FL round: 2 is 0.019960000000000002
INFO:root:Train Epoch: 1 [0/297 (0%)]	Loss: 1.866994
INFO:root:Train Epoch: 2 [0/297 (0%)]	Loss: 1.572090
INFO:root:Train Epoch: 3 [0/297 (0%)]	Loss: 1.530476
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 2 |, is 1.3060903549194336
INFO:root:@@@@@@@@ Working on client (global-index): 55, which 1-th user in the current round
INFO:root:Effective lr in FL round: 2 is 0.019960000000000002
INFO:root:Train Epoch: 1 [0/119 (0%)]	Loss: 1.688041
INFO:root:Train Epoch: 2 [0/119 (0%)]	Loss: 1.536909
INFO:root:Train Epoch: 3 [0/119 (0%)]	Loss: 1.554908
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 2 |, is 0.4831000566482544
INFO:root:@@@@@@@@ Working on client (global-index): 89, which 2-th user in the current round
INFO:root:Effective lr in FL round: 2 is 0.019960000000000002
INFO:root:Train Epoch: 1 [0/293 (0%)]	Loss: 1.715358
INFO:root:Train Epoch: 2 [0/293 (0%)]	Loss: 1.640645
INFO:root:Train Epoch: 3 [0/293 (0%)]	Loss: 1.587536
INFO:root:===> ND `|w_normal-w_g|` in local epoch: 3 | FL round: 2 |, is 1.1906229257583618
INFO:root:@@@@@@@@ Working on client (global-index): 60, which 3-th user in the current round
INFO:root:Effective lr in FL round: 2 is 0.019960000000000002
INFO:root:Train Epoch: 1 [0/600 (0%)]	Loss: 1.949750
INFO:root:Train Epoch: 2 [0/600 (0%)]	Loss: 1.582891
INFO:root:Train Epoch: 3 [0/600 (0%)]	Loss: 1.641222
INFO:root:Accuracy of plane : 63.30 %
INFO:root:Accuracy of   car : 79.90 %
INFO:root:Accuracy of  bird : 62.50 %
INFO:root:Accuracy of   cat : 52.00 %
INFO:root:Accuracy of  deer : 76.20 %
INFO:root:Accuracy of   dog : 72.60 %
INFO:root:Accuracy of  frog : 82.70 %
INFO:root:Accuracy of horse : 83.20 %
INFO:root:Accuracy of  ship : 89.90 %
INFO:root:Accuracy of truck : 85.10 %
INFO:root:
Test set: Average loss: 0.0017, Accuracy: 7474/10000 (74.74%)

INFO:root:#### Targetted Accuracy of truck : 97.96 %
INFO:root:===> ND `|w_bad-w_g|` in local epoch: 3 | FL round: 2 |, is 1.9949841499328613
INFO:root:@@@@@@@@ Working on client (global-index): 148, which 4-th user in the current round
INFO:root:Effective lr in FL round: 2 is 0.019960000000000002
INFO:root:Train Epoch: 1 [0/291 (0%)]	Loss: 1.618495
 0.5
[Soft-filter] predicted suspicious set is:  [101, 71, 24, 9]
Total computation time of the 1st layer is: 1.208740234375
[Hard-filter] predicted suspicious set is:  [71, 24, 9]
Total computation time of the 2nd layer is: 249.140625
[Final-result] predicted suspicious set is: [101, 71, 24, 9]
verifier: 13, true positive: 1.0, true negative: 0.5, false positive: 0.5

------------------------------------------------------------------------------------
epsilon_1:  0.40300701948558937
[Soft-filter] predicted suspicious set is:  [63, 101]
Total computation time of the 1st layer is: 1.26953125
[Hard-filter] predicted suspicious set is:  [63, 101]
Total computation time of the 2nd layer is: 251.471923828125
[Final-result] predicted suspicious set is: [63, 101]
verifier: 14, true positive: 1.0, true negative: 0.6, false positive: 0.4

------------------------------------------------------------------------------------
epsilon_1:  0.33452950577014434
[Soft-filter] predicted suspicious set is:  [129, 50]
Total computation time of the 1st layer is: 1.21142578125
[Hard-filter] predicted suspicious set is:  [58, 158]
Total computation time of the 2nd layer is: 233.79736328125
[Final-result] predicted suspicious set is: [129, 50]
verifier: 15, true positive: 1.0, true negative: 0.75, false positive: 0.25

------------------------------------------------------------------------------------
epsilon_1:  0.5
[Soft-filter] predicted suspicious set is:  [71, 62, 4, 9]
Total computation time of the 1st layer is: 1.412353515625
[Hard-filter] predicted suspicious set is:  [71, 9]
Total computation time of the 2nd layer is: 235.881591796875
[Final-result] predicted suspicious set is: [71, 62, 4, 9]
verifier: 16, true positive: 1.0, true negative: 0.33333333333333337, false positive: 0.6666666666666666

------------------------------------------------------------------------------------
epsilon_1:  0.49970789073562644
[Soft-filter] predicted suspicious set is:  [129, 147]
Total computation time of the 1st layer is: 2.165771484375
[Hard-filter] predicted suspicious set is:  [129, 147, 50]
Total computation time of the 2nd layer is: 229.800048828125
[Final-result] predicted suspicious set is: [129, 147]
verifier: 17, true positive: 1.0, true negative: 1.0, false positive: 0.0

------------------------------------------------------------------------------------
epsilon_1:  0.3613635120498485
[Soft-filter] predicted suspicious set is:  [9, 62]
Total computation time of the 1st layer is: 1.460205078125
[Hard-filter] predicted suspicious set is:  [62]
Total computation time of the 2nd layer is: 234.7958984375
[Final-result] predicted suspicious set is: [9, 62]
verifier: 18, true positive: 1.0, true negative: 0.75, false positive: 0.25

------------------------------------------------------------------------------------
epsilon_1:  0.19531289356484183
[Soft-filter] predicted suspicious set is:  [62, 124]
Total computation time of the 1st layer is: 1.239501953125
[Hard-filter] predicted suspicious set is:  [62, 124]
Total computation time of the 2nd layer is: 213.874755859375
[Final-result] predicted suspicious set is: [62, 124]
verifier: 19, true positive: 1.0, true negative: 0.6, false positive: 0.4

------------------------------------------------------------------------------------
epsilon_1:  0.5
[Soft-filter] predicted suspicious set is:  [50, 147, 62]
Total computation time of the 1st layer is: 1.220947265625
[Hard-filter] predicted suspicious set is:  [62]
Total computation time of the 2nd layer is: 213.510498046875
[Final-result] predicted suspicious set is: [50, 147, 62]
verifier: 20, true positive: 1.0, true negative: 0.5, false positive: 0.5

------------------------------------------------------------------------------------
epsilon_1:  0.12862026707708607
[Soft-filter] predicted suspicious set is:  [197, 138]
Total computation time of the 1st layer is: 1.3310546875
[Hard-filter] predicted suspicious set is:  [158, 66, 138]
Total computation time of the 2nd layer is: 223.091064453125
[Final-result] predicted suspicious set is: [197, 138]
verifier: 21, true positive: 1.0, true negative: 0.75, false positive: 0.25

------------------------------------------------------------------------------------
epsilon_1:  0.2804794986124043
[Soft-filter] predicted suspicious set is:  [147, 4]
Total computation time of the 1st layer is: 1.26953125
[Hard-filter] predicted suspicious set is:  [137]
Total computation time of the 2nd layer is: 304.65087890625
[Final-result] predicted suspicious set is: [147, 4]
verifier: 22, true positive: 1.0, true negative: 0.75, false positive: 0.25

------------------------------------------------------------------------------------
Flr: 1, attacked verifier: 5

Flr: 1, true positive: 1.0, true negative: 0.5909090909090908, false positive: 0.4090909090909091

selected_node_indices:  [138  14 113 153  24 137 126 109   6  44  71  45 197  63 147   9  54  64
  58   4 124  66  62 134 101 129  50 102 158  21]
Flr: 1, honest client after all verify: [14, 113, 137, 126, 6, 44, 45, 54, 64, 58, 66, 134, 158]
Flr: 1, detect attacker: [138, 153, 24, 109, 71, 197, 63, 147, 9, 4, 124, 62, 101, 129, 50, 102, 21]
Flr: 1,true attackers: [138, 24, 109, 71, 147, 9, 129, 102]
Flr: 1, number not verify: 0
num_data_points:  [297, 119, 293, 600, 291, 277, 600, 170, 153, 244, 216, 224, 313, 600, 389, 292, 600, 180, 321, 600, 287, 104, 257, 286, 251, 600, 300, 376, 285, 263]
total_num_dps_per_round: 9788
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Traceback (most recent call last):
  File "simulated_averaging_distributed.py", line 275, in <module>
    wandb_logging = fixed_pool_fl_trainer.run(wandb_ins)
  File "/mnt/disk1/duongnh/Distributed_FedGrad/fl_trainer_distributed.py", line 594, in run
    train(net, self.device, train_dl_local, optimizer, e, log_interval=self.log_interval, criterion=self.criterion)
  File "/mnt/disk1/duongnh/Distributed_FedGrad/fl_trainer_distributed.py", line 159, in train
    for batch_idx, (data, target) in enumerate(train_loader):
  File "/mnt/disk1/anaconda3/envs/longnd/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 521, in __next__
    data = self._next_data()
  File "/mnt/disk1/anaconda3/envs/longnd/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 561, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/mnt/disk1/anaconda3/envs/longnd/lib/python3.7/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/mnt/disk1/anaconda3/envs/longnd/lib/python3.7/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/mnt/disk1/duongnh/Distributed_FedGrad/datasets.py", line 341, in __getitem__
    img, target = self.data[index], self.target[index]
KeyboardInterrupt
wandb: Waiting for W&B process to finish... (failed 255). Press Control-C to abort syncing.
wandb: - 0.002 MB of 0.002 MB uploaded (0.000 MB deduped)wandb: \ 0.002 MB of 0.002 MB uploaded (0.000 MB deduped)wandb: | 0.002 MB of 0.002 MB uploaded (0.000 MB deduped)wandb: / 0.002 MB of 0.039 MB uploaded (0.000 MB deduped)wandb: - 0.002 MB of 0.050 MB uploaded (0.000 MB deduped)wandb: \ 0.002 MB of 0.050 MB uploaded (0.000 MB deduped)wandb: | 0.002 MB of 0.050 MB uploaded (0.000 MB deduped)wandb: / 0.002 MB of 0.050 MB uploaded (0.000 MB deduped)wandb: - 0.002 MB of 0.050 MB uploaded (0.000 MB deduped)wandb: \ 0.002 MB of 0.050 MB uploaded (0.000 MB deduped)wandb: | 0.002 MB of 0.050 MB uploaded (0.000 MB deduped)wandb: / 0.034 MB of 0.050 MB uploaded (0.000 MB deduped)wandb: - 0.034 MB of 0.050 MB uploaded (0.000 MB deduped)wandb: \ 0.034 MB of 0.050 MB uploaded (0.000 MB deduped)wandb: | 0.034 MB of 0.050 MB uploaded (0.000 MB deduped)wandb: / 0.039 MB of 0.050 MB uploaded (0.000 MB deduped)wandb: - 0.048 MB of 0.050 MB uploaded (0.000 MB deduped)wandb: \ 0.050 MB of 0.050 MB uploaded (0.000 MB deduped)wandb: | 0.050 MB of 0.050 MB uploaded (0.000 MB deduped)wandb: / 0.050 MB of 0.050 MB uploaded (0.000 MB deduped)wandb: - 0.050 MB of 0.050 MB uploaded (0.000 MB deduped)wandb: \ 0.050 MB of 0.050 MB uploaded (0.000 MB deduped)wandb: | 0.050 MB of 0.050 MB uploaded (0.000 MB deduped)wandb: / 0.050 MB of 0.050 MB uploaded (0.000 MB deduped)wandb: - 0.050 MB of 0.050 MB uploaded (0.000 MB deduped)wandb:                                                                                
wandb: Synced my_server_test: https://wandb.ai/aiotlab/Distributed%20Backdoor%20Attack%20FedGrad/runs/20cx7xvk
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20230615_130116-20cx7xvk/logs
